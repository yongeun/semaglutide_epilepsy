========= TMLE Analysis: GLP1 vs SGLT2 - Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing Epilepsy/Seizure patients: 7034 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 378 
Patients eligible for analysis: 6656 
=======================================
After excluding pre-existing Epilepsy/Seizure patients: 6656 (excluded: 378 patients)
- Input data rows: 6656 
- Patients with outcome dates: 125 
- Outcome date range: 17701 to 19631 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 5497 
- Raw events (before late-onset filter): 96 
- Events after time >= 0 filter: 96 
- Patients filtered out due to event_time < 0: 817 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2085 
- Mean event_time: 879.4891 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 18                                  96 
No event - administrative censoring 
                               5725 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 5839 
Total events: 96 

Index Year Distribution:

2018 2019 2020 2021 
 720 1279 1483 2357 
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SGLT2_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.0095823
   Estimated Variance:  8.3747e-06
              p-value:  0.00092899
    95% Conf Interval:  (0.0039103, 0.015254)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.019247
   Estimated Variance:  4.843e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.014934, 0.02356)

 Additive Effect
   Parameter Estimate:  -0.0096647
   Estimated Variance:  1.3294e-05
              p-value:  0.0080333
    95% Conf Interval:  (-0.016811, -0.0025184)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0074829
   Estimated Variance:  1.0068e-05
              p-value:  0.018358
    95% Conf Interval:  (-0.013702, -0.001264)

 Additive Effect among the Controls
   Parameter Estimate:  -0.010545
   Estimated Variance:  1.6307e-05
              p-value:  0.0090192
    95% Conf Interval:  (-0.01846, -0.0026303)

 Relative Risk
   Parameter  Estimate: 0.49786
   Variance(log scale): 0.1047
               p-value: 0.031126
     95% Conf Interval: (0.26405, 0.9387)

 Odds Ratio
   Parameter  Estimate: 0.493
   Variance(log scale): 0.107
               p-value: 0.03061
     95% Conf Interval: (0.25966, 0.93601)

Average Treatment Effect (Risk Difference): -0.0097 (95% CI: -0.0168 to -0.0025 ) p = 0.00803 

Odds Ratio: 0.49 (95% CI: 0.26 to 0.94 ) p = 0.0306 

Number Needed to Treat (NNT): 103.5 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events    rate
      <dbl> <int>  <int>   <dbl>
1         0  4066     81 0.0199 
2         1  1773     15 0.00846

--- HbA1c Mediation Analysis for Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 5839 
Patients with baseline HbA1c data: 5405 
Patients with mean HbA1c data: 4292 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.05 SD: 1.86 
1-Year Mean HbA1c - Mean: 7.61 SD: 1.56 
Correlation between baseline and 1-year mean: 0.759 

Diagnostic after outcome redefinition:
Total patients: 5572 
Total events: 86 

Diagnostic after HbA1c filtering:
Remaining patients: 5180 
Remaining events: 82 
Events by treatment:
   
       0    1
  0 3518   70
  1 1580   12

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
              Estimate Std. Error   t value     Pr(>|t|)
(Intercept)  8.9731500 0.13701113  65.49213 0.000000e+00
treatment   -0.6830555 0.05136014 -13.29933 1.493089e-39

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                 Estimate Std. Error   z value   Pr(>|z|)
treatment      -0.8832643 0.34961351 -2.526402 0.01152375
hba1c_mean_6mo  0.1547276 0.06732096  2.298358 0.02154143

=== TMLE Mediation Analysis Summary for Epilepsy/Seizure ===
A path (Treatment → HbA1c): -0.6830555 p = 1.493089e-39 
B path (HbA1c → Outcome): 0.1547276 p = 0.02154143 
C path (Direct Effect): -0.8832643 p = 0.01152375 
Indirect Effect (A*B): -0.1056876 p = 0.02352577 (Sobel test)
Total Effect (C + A*B): -0.9889519 

--- HbA1c Mediation Analysis End for Epilepsy/Seizure ---

========= HbA1c Trajectory Analysis: GLP1 vs SGLT2 - Epilepsy/Seizure =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.22       3755
2         1                7.67       1650


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                         Estimate  Std. Error       df     t value
(Intercept)            1.25124997 0.035049714 6360.013  35.6992920
baseline_a1c           0.83252096 0.004092159 6267.902 203.4429710
years_since           -0.37041225 0.020263019 4424.279 -18.2802107
treatment             -0.12361512 0.016986284 6684.275  -7.2773492
years_since:treatment -0.01975715 0.036511056 4455.739  -0.5411279
                           Pr(>|t|)
(Intercept)           1.415191e-254
baseline_a1c           0.000000e+00
years_since            5.022833e-72
treatment              3.793698e-13
years_since:treatment  5.884465e-01

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 27212' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 27212)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 27212' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 27212)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 27212' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 27212)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 27212' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 27212)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for Epilepsy/Seizure (TMLE) ====
                         Estimate  Std. Error      Pr(>|t|)
(Intercept)            1.25124997 0.035049714 1.415191e-254
baseline_a1c           0.83252096 0.004092159  0.000000e+00
years_since           -0.37041225 0.020263019  5.022833e-72
treatment             -0.12361512 0.016986284  3.793698e-13
years_since:treatment -0.01975715 0.036511056  5.884465e-01
# A tibble: 5 × 9
  effect term    estimate std.error statistic    df   p.value conf.low conf.high
  <chr>  <chr>      <dbl>     <dbl>     <dbl> <dbl>     <dbl>    <dbl>     <dbl>
1 fixed  (Inter…   1.25     0.0350     35.7   6360. 1.42e-254   1.18      1.32  
2 fixed  baseli…   0.833    0.00409   203.    6268. 0           0.824     0.841 
3 fixed  years_…  -0.370    0.0203    -18.3   4424. 5.02e- 72  -0.410    -0.331 
4 fixed  treatm…  -0.124    0.0170     -7.28  6684. 3.79e- 13  -0.157    -0.0903
5 fixed  years_…  -0.0198   0.0365     -0.541 4456. 5.88e-  1  -0.0913    0.0518

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  8.022 0.00922 Inf     8.004     8.040
         1  7.899 0.01420 Inf     7.871     7.926

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.652 0.01960 Inf     7.613     7.690
         1  7.508 0.02930 Inf     7.451     7.566

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.281 0.03880 Inf     7.205     7.357
         1  7.118 0.05800 Inf     7.005     7.232

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.124 (p = 3.79e-13 )
Time×Treatment Interaction (HbA1c change over time): -0.02 (p = 0.588 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  4066     81
2         1  1773     15

========= TMLE Analysis: GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: TRUE 

Before excluding pre-existing Early-onset Epilepsy/Seizure patients: 7034 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 378 
Patients eligible for analysis: 6656 
=======================================
After excluding pre-existing Early-onset Epilepsy/Seizure patients: 6656 (excluded: 378 patients)
- Input data rows: 6656 
- Patients with outcome dates: 125 
- Outcome date range: 17701 to 19631 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 5497 
- Raw events (before late-onset filter): 96 
- Events after time >= 0 filter: 13 
- Patients filtered out due to event_time < 0: 817 
- Early-onset applied: events with age < 50: 13 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2085 
- Mean event_time: 879.4891 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 18                                  96 
No event - administrative censoring 
                               5725 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 5839 
Total events: 13 

Index Year Distribution:

2018 2019 2020 2021 
 720 1279 1483 2357 
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SGLT2_Early-onset_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.001846
   Estimated Variance:  8.1356e-07
              p-value:  0.040699
    95% Conf Interval:  (7.8126e-05, 0.0036138)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.0026665
   Estimated Variance:  9.2961e-07
              p-value:  0.0056817
    95% Conf Interval:  (0.00077678, 0.0045562)

 Additive Effect
   Parameter Estimate:  -0.00082054
   Estimated Variance:  1.8173e-06
              p-value:  0.54273
    95% Conf Interval:  (-0.0034627, 0.0018216)

 Additive Effect among the Treated
   Parameter Estimate:  0.0008259
   Estimated Variance:  3.4862e-06
              p-value:  0.65825
    95% Conf Interval:  (-0.0028336, 0.0044854)

 Additive Effect among the Controls
   Parameter Estimate:  0.00029881
   Estimated Variance:  1.325e-06
              p-value:  0.79518
    95% Conf Interval:  (-0.0019573, 0.0025549)

 Relative Risk
   Parameter  Estimate: 0.69228
   Variance(log scale): 0.38455
               p-value: 0.55314
     95% Conf Interval: (0.20532, 2.3341)

 Odds Ratio
   Parameter  Estimate: 0.69171
   Variance(log scale): 0.3862
               p-value: 0.5531
     95% Conf Interval: (0.20462, 2.3383)

Average Treatment Effect (Risk Difference): -8e-04 (95% CI: -0.0035 to 0.0018 ) p = 0.543 

Odds Ratio: 0.69 (95% CI: 0.2 to 2.34 ) p = 0.553 

Number Needed to Treat (NNT): 1218.7 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events    rate
      <dbl> <int>  <int>   <dbl>
1         0  4066      9 0.00221
2         1  1773      4 0.00226


--- HbA1c Mediation Analysis for Early-onset Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 5839 
Patients with baseline HbA1c data: 5405 
Patients with mean HbA1c data: 4292 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.05 SD: 1.86 
1-Year Mean HbA1c - Mean: 7.61 SD: 1.56 
Correlation between baseline and 1-year mean: 0.759 

Diagnostic after outcome redefinition:
Total patients: 5572 
Total events: 86 

Diagnostic after HbA1c filtering:
Remaining patients: 5180 
Remaining events: 82 
Events by treatment:
   
       0    1
  0 3518   70
  1 1580   12

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
              Estimate Std. Error   t value     Pr(>|t|)
(Intercept)  8.9731500 0.13701113  65.49213 0.000000e+00
treatment   -0.6830555 0.05136014 -13.29933 1.493089e-39

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                 Estimate Std. Error   z value   Pr(>|z|)
treatment      -0.8832643 0.34961351 -2.526402 0.01152375
hba1c_mean_6mo  0.1547276 0.06732096  2.298358 0.02154143

=== TMLE Mediation Analysis Summary for Early-onset Epilepsy/Seizure ===
A path (Treatment → HbA1c): -0.6830555 p = 1.493089e-39 
B path (HbA1c → Outcome): 0.1547276 p = 0.02154143 
C path (Direct Effect): -0.8832643 p = 0.01152375 
Indirect Effect (A*B): -0.1056876 p = 0.02352577 (Sobel test)
Total Effect (C + A*B): -0.9889519 

--- HbA1c Mediation Analysis End for Early-onset Epilepsy/Seizure ---

========= HbA1c Trajectory Analysis: GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.22       3755
2         1                7.67       1650


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                         Estimate  Std. Error       df     t value
(Intercept)            1.25124997 0.035049714 6360.013  35.6992920
baseline_a1c           0.83252096 0.004092159 6267.902 203.4429710
years_since           -0.37041225 0.020263019 4424.279 -18.2802107
treatment             -0.12361512 0.016986284 6684.275  -7.2773492
years_since:treatment -0.01975715 0.036511056 4455.739  -0.5411279
                           Pr(>|t|)
(Intercept)           1.415191e-254
baseline_a1c           0.000000e+00
years_since            5.022833e-72
treatment              3.793698e-13
years_since:treatment  5.884465e-01

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 27212' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 27212)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 27212' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 27212)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 27212' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 27212)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 27212' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 27212)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for Early-onset Epilepsy/Seizure (TMLE) ====
                         Estimate  Std. Error      Pr(>|t|)
(Intercept)            1.25124997 0.035049714 1.415191e-254
baseline_a1c           0.83252096 0.004092159  0.000000e+00
years_since           -0.37041225 0.020263019  5.022833e-72
treatment             -0.12361512 0.016986284  3.793698e-13
years_since:treatment -0.01975715 0.036511056  5.884465e-01
# A tibble: 5 × 9
  effect term    estimate std.error statistic    df   p.value conf.low conf.high
  <chr>  <chr>      <dbl>     <dbl>     <dbl> <dbl>     <dbl>    <dbl>     <dbl>
1 fixed  (Inter…   1.25     0.0350     35.7   6360. 1.42e-254   1.18      1.32  
2 fixed  baseli…   0.833    0.00409   203.    6268. 0           0.824     0.841 
3 fixed  years_…  -0.370    0.0203    -18.3   4424. 5.02e- 72  -0.410    -0.331 
4 fixed  treatm…  -0.124    0.0170     -7.28  6684. 3.79e- 13  -0.157    -0.0903
5 fixed  years_…  -0.0198   0.0365     -0.541 4456. 5.88e-  1  -0.0913    0.0518

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  8.022 0.00922 Inf     8.004     8.040
         1  7.899 0.01420 Inf     7.871     7.926

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.652 0.01960 Inf     7.613     7.690
         1  7.508 0.02930 Inf     7.451     7.566

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.281 0.03880 Inf     7.205     7.357
         1  7.118 0.05800 Inf     7.005     7.232

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.124 (p = 3.79e-13 )
Time×Treatment Interaction (HbA1c change over time): -0.02 (p = 0.588 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  4066      9
2         1  1773      4

========= TMLE Analysis: GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: TRUE 
- early_onset: FALSE 

Before excluding pre-existing Late-onset Epilepsy/Seizure patients: 7034 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 378 
Patients eligible for analysis: 6656 
=======================================
After excluding pre-existing Late-onset Epilepsy/Seizure patients: 6656 (excluded: 378 patients)
- Input data rows: 6656 
- Patients with outcome dates: 125 
- Outcome date range: 17701 to 19631 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 5497 
- Raw events (before late-onset filter): 96 
- Events after time >= 0 filter: 83 
- Patients filtered out due to event_time < 0: 817 
- Late-onset applied: events with age >= 50: 83 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2085 
- Mean event_time: 879.4891 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 18                                  96 
No event - administrative censoring 
                               5725 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 5839 
Total events: 83 

Index Year Distribution:

2018 2019 2020 2021 
 720 1279 1483 2357 
After age filtering (≥ 50 ): samples = 5114 , events = 82 
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SGLT2_Late-onset_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.0087465
   Estimated Variance:  9.0164e-06
              p-value:  0.0035815
    95% Conf Interval:  (0.0028613, 0.014632)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.018636
   Estimated Variance:  5.1786e-06
              p-value:  2.626e-16
    95% Conf Interval:  (0.014176, 0.023096)

 Additive Effect
   Parameter Estimate:  -0.0098896
   Estimated Variance:  1.4293e-05
              p-value:  0.0088994
    95% Conf Interval:  (-0.017299, -0.0024798)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0082817
   Estimated Variance:  1.0306e-05
              p-value:  0.0098884
    95% Conf Interval:  (-0.014574, -0.0019896)

 Additive Effect among the Controls
   Parameter Estimate:  -0.010509
   Estimated Variance:  1.7252e-05
              p-value:  0.011405
    95% Conf Interval:  (-0.018649, -0.0023679)

 Relative Risk
   Parameter  Estimate: 0.46933
   Variance(log scale): 0.13337
               p-value: 0.038328
     95% Conf Interval: (0.22942, 0.96015)

 Odds Ratio
   Parameter  Estimate: 0.46465
   Variance(log scale): 0.13605
               p-value: 0.037707
     95% Conf Interval: (0.22551, 0.95739)

Average Treatment Effect (Risk Difference): -0.0099 (95% CI: -0.0173 to -0.0025 ) p = 0.0089 

Odds Ratio: 0.46 (95% CI: 0.23 to 0.96 ) p = 0.0377 

Number Needed to Treat (NNT): 101.1 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events    rate
      <dbl> <int>  <int>   <dbl>
1         0  3646     71 0.0195 
2         1  1468     11 0.00749


--- HbA1c Mediation Analysis for Late-onset Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 5114 
Patients with baseline HbA1c data: 4740 
Patients with mean HbA1c data: 3777 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.02 SD: 1.81 
1-Year Mean HbA1c - Mean: 7.59 SD: 1.5 
Correlation between baseline and 1-year mean: 0.754 

Diagnostic after outcome redefinition:
Total patients: 4887 
Total events: 76 

Diagnostic after HbA1c filtering:
Remaining patients: 4549 
Remaining events: 72 
Events by treatment:
   
       0    1
  0 3163   63
  1 1314    9

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
              Estimate Std. Error   t value     Pr(>|t|)
(Intercept)  9.2834619 0.18976998  48.91955 0.000000e+00
treatment   -0.6450851 0.05321112 -12.12313 3.424236e-33

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                 Estimate Std. Error   z value   Pr(>|z|)
treatment      -0.9652721 0.38640494 -2.498084 0.01248665
hba1c_mean_6mo  0.1053469 0.07669604  1.373564 0.16957701

=== TMLE Mediation Analysis Summary for Late-onset Epilepsy/Seizure ===
A path (Treatment → HbA1c): -0.6450851 p = 3.424236e-33 
B path (HbA1c → Outcome): 0.1053469 p = 0.169577 
C path (Direct Effect): -0.9652721 p = 0.01248665 
Indirect Effect (A*B): -0.06795774 p = 0.1723059 (Sobel test)
Total Effect (C + A*B): -1.03323 

--- HbA1c Mediation Analysis End for Late-onset Epilepsy/Seizure ---

========= HbA1c Trajectory Analysis: GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.17       3373
2         1                7.64       1367


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                        Estimate  Std. Error       df     t value      Pr(>|t|)
(Intercept)            1.3024799 0.037390432 5532.892  34.8345773 1.469937e-240
baseline_a1c           0.8256930 0.004397301 5434.725 187.7726998  0.000000e+00
years_since           -0.3593408 0.020373225 3909.528 -17.6378945  4.681380e-67
treatment             -0.1195354 0.018074162 5861.631  -6.6136058  4.082935e-11
years_since:treatment -0.0193163 0.037681016 3924.244  -0.5126269  6.082412e-01

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 24202' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 24202)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 24202' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 24202)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 24202' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 24202)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 24202' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 24202)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for Late-onset Epilepsy/Seizure (TMLE) ====
                        Estimate  Std. Error      Pr(>|t|)
(Intercept)            1.3024799 0.037390432 1.469937e-240
baseline_a1c           0.8256930 0.004397301  0.000000e+00
years_since           -0.3593408 0.020373225  4.681380e-67
treatment             -0.1195354 0.018074162  4.082935e-11
years_since:treatment -0.0193163 0.037681016  6.082412e-01
# A tibble: 5 × 9
  effect term    estimate std.error statistic    df   p.value conf.low conf.high
  <chr>  <chr>      <dbl>     <dbl>     <dbl> <dbl>     <dbl>    <dbl>     <dbl>
1 fixed  (Inter…   1.30     0.0374     34.8   5533. 1.47e-240   1.23      1.38  
2 fixed  baseli…   0.826    0.00440   188.    5435. 0           0.817     0.834 
3 fixed  years_…  -0.359    0.0204    -17.6   3910. 4.68e- 67  -0.399    -0.319 
4 fixed  treatm…  -0.120    0.0181     -6.61  5862. 4.08e- 11  -0.155    -0.0841
5 fixed  years_…  -0.0193   0.0377     -0.513 3924. 6.08e-  1  -0.0932    0.0546

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.993 0.00956 Inf     7.974     8.011
         1  7.873 0.01530 Inf     7.843     7.903

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.633 0.01970 Inf     7.595     7.672
         1  7.494 0.03060 Inf     7.434     7.554

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.274 0.03890 Inf     7.198     7.350
         1  7.116 0.06040 Inf     6.997     7.234

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.12 (p = 4.08e-11 )
Time×Treatment Interaction (HbA1c change over time): -0.019 (p = 0.608 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  3646     71
2         1  1468     11

========= TMLE Analysis: GLP1 vs SGLT2 - ADRD =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: adrd_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing ADRD patients: 7034 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
ADRD diagnosed BEFORE index date (excluding): 242 
Patients eligible for analysis: 6792 
=======================================
After excluding pre-existing ADRD patients: 6792 (excluded: 242 patients)
- Input data rows: 6792 
- Patients with outcome dates: 214 
- Outcome date range: 17900 to 19629 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 5602 
- Raw events (before late-onset filter): 159 
- Events after time >= 0 filter: 159 
- Patients filtered out due to event_time < 0: 842 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2085 
- Mean event_time: 881.3896 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 39                                 159 
No event - administrative censoring 
                               5752 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 5950 
Total events: 159 

Index Year Distribution:

2018 2019 2020 2021 
 740 1320 1487 2403 
Excluding 'dem' covariate for ADRD outcome
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SGLT2_ADRD.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.019413
   Estimated Variance:  1.8668e-05
              p-value:  7.0187e-06
    95% Conf Interval:  (0.010945, 0.027881)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.030208
   Estimated Variance:  6.8273e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.025087, 0.035329)

 Additive Effect
   Parameter Estimate:  -0.010795
   Estimated Variance:  2.5454e-05
              p-value:  0.032385
    95% Conf Interval:  (-0.020683, -0.00090643)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0041002
   Estimated Variance:  1.5032e-05
              p-value:  0.29027
    95% Conf Interval:  (-0.011699, 0.0034989)

 Additive Effect among the Controls
   Parameter Estimate:  -0.013537
   Estimated Variance:  3.3319e-05
              p-value:  0.019021
    95% Conf Interval:  (-0.02485, -0.0022232)

 Relative Risk
   Parameter  Estimate: 0.64265
   Variance(log scale): 0.056945
               p-value: 0.063901
     95% Conf Interval: (0.40258, 1.0259)

 Odds Ratio
   Parameter  Estimate: 0.63558
   Variance(log scale): 0.059396
               p-value: 0.062932
     95% Conf Interval: (0.3942, 1.0247)

Average Treatment Effect (Risk Difference): -0.0108 (95% CI: -0.0207 to -9e-04 ) p = 0.0324 

Odds Ratio: 0.64 (95% CI: 0.39 to 1.02 ) p = 0.0629 

Number Needed to Treat (NNT): 92.6 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  4136    130 0.0314
2         1  1814     29 0.0160


--- HbA1c Mediation Analysis for ADRD ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 5950 
Patients with baseline HbA1c data: 5511 
Patients with mean HbA1c data: 4371 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.06 SD: 1.87 
1-Year Mean HbA1c - Mean: 7.62 SD: 1.57 
Correlation between baseline and 1-year mean: 0.757 

Diagnostic after outcome redefinition:
Total patients: 5686 
Total events: 145 

Diagnostic after HbA1c filtering:
Remaining patients: 5286 
Remaining events: 145 
Events by treatment:
   
       0    1
  0 3537  118
  1 1604   27

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
              Estimate Std. Error   t value     Pr(>|t|)
(Intercept)  8.9782666 0.13524808  66.38369 0.000000e+00
treatment   -0.6903346 0.05108877 -13.51245 9.180955e-41

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                 Estimate Std. Error   z value   Pr(>|z|)
treatment      -0.4371544 0.23881340 -1.830527 0.06717114
hba1c_mean_6mo  0.1472744 0.05802096  2.538297 0.01113933

=== TMLE Mediation Analysis Summary for ADRD ===
A path (Treatment → HbA1c): -0.6903346 p = 9.180955e-41 
B path (HbA1c → Outcome): 0.1472744 p = 0.01113933 
C path (Direct Effect): -0.4371544 p = 0.06717114 
Indirect Effect (A*B): -0.1016686 p = 0.01260764 (Sobel test)
Total Effect (C + A*B): -0.5388231 

--- HbA1c Mediation Analysis End for ADRD ---

========= HbA1c Trajectory Analysis: GLP1 vs SGLT2 - ADRD =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.24       3823
2         1                7.68       1688


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                         Estimate  Std. Error       df     t value
(Intercept)            1.24199687 0.034828586 6496.187  35.6602728
baseline_a1c           0.83395591 0.004054736 6384.238 205.6745101
years_since           -0.37132747 0.020247892 4499.681 -18.3390679
treatment             -0.12431704 0.016945036 6844.243  -7.3364868
years_since:treatment -0.02442051 0.036429754 4532.654  -0.6703452
                           Pr(>|t|)
(Intercept)           1.585516e-254
baseline_a1c           0.000000e+00
years_since            1.667794e-72
treatment              2.445629e-13
years_since:treatment  5.026719e-01

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 27768' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 27768)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 27768' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 27768)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 27768' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 27768)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 27768' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 27768)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for ADRD (TMLE) ====
                         Estimate  Std. Error      Pr(>|t|)
(Intercept)            1.24199687 0.034828586 1.585516e-254
baseline_a1c           0.83395591 0.004054736  0.000000e+00
years_since           -0.37132747 0.020247892  1.667794e-72
treatment             -0.12431704 0.016945036  2.445629e-13
years_since:treatment -0.02442051 0.036429754  5.026719e-01
# A tibble: 5 × 9
  effect term    estimate std.error statistic    df   p.value conf.low conf.high
  <chr>  <chr>      <dbl>     <dbl>     <dbl> <dbl>     <dbl>    <dbl>     <dbl>
1 fixed  (Inter…   1.24     0.0348     35.7   6496. 1.59e-254   1.17      1.31  
2 fixed  baseli…   0.834    0.00405   206.    6384. 0           0.826     0.842 
3 fixed  years_…  -0.371    0.0202    -18.3   4500. 1.67e- 72  -0.411    -0.332 
4 fixed  treatm…  -0.124    0.0169     -7.34  6844. 2.45e- 13  -0.158    -0.0911
5 fixed  years_…  -0.0244   0.0364     -0.670 4533. 5.03e-  1  -0.0958    0.0470

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  8.040 0.00921 Inf     8.022     8.058
         1  7.915 0.01420 Inf     7.887     7.943

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.668 0.01960 Inf     7.630     7.707
         1  7.519 0.02920 Inf     7.462     7.577

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.297 0.03870 Inf     7.221     7.373
         1  7.124 0.05780 Inf     7.010     7.237

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.124 (p = 2.45e-13 )
Time×Treatment Interaction (HbA1c change over time): -0.024 (p = 0.503 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  4136    130
2         1  1814     29

========= TMLE Analysis: GLP1 vs SGLT2 - stroke =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: stroke_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing stroke patients: 7034 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Stroke diagnosed BEFORE index date (excluding): 668 
Patients eligible for analysis: 6366 
=======================================
After excluding pre-existing stroke patients: 6366 (excluded: 668 patients)
- Input data rows: 6366 
- Patients with outcome dates: 229 
- Outcome date range: 17564 to 19621 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 5235 
- Raw events (before late-onset filter): 181 
- Events after time >= 0 filter: 181 
- Patients filtered out due to event_time < 0: 789 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2085 
- Mean event_time: 875.86 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 33                                 181 
No event - administrative censoring 
                               5363 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 5577 
Total events: 181 

Index Year Distribution:

2018 2019 2020 2021 
 694 1239 1386 2258 
Excluding 'cvd' covariate for Stroke outcome
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SGLT2_stroke.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.035765
   Estimated Variance:  4.3469e-05
              p-value:  5.8084e-08
    95% Conf Interval:  (0.022843, 0.048687)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.032708
   Estimated Variance:  8.3588e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.027041, 0.038374)

 Additive Effect
   Parameter Estimate:  0.0030572
   Estimated Variance:  5.1827e-05
              p-value:  0.67108
    95% Conf Interval:  (-0.011053, 0.017167)

 Additive Effect among the Treated
   Parameter Estimate:  0.0015803
   Estimated Variance:  2.4439e-05
              p-value:  0.74922
    95% Conf Interval:  (-0.0081089, 0.01127)

 Additive Effect among the Controls
   Parameter Estimate:  0.0038519
   Estimated Variance:  7.4258e-05
              p-value:  0.65488
    95% Conf Interval:  (-0.013038, 0.020742)

 Relative Risk
   Parameter  Estimate: 1.0935
   Variance(log scale): 0.041796
               p-value: 0.66205
     95% Conf Interval: (0.73247, 1.6324)

 Odds Ratio
   Parameter  Estimate: 1.0969
   Variance(log scale): 0.044901
               p-value: 0.66238
     95% Conf Interval: (0.72413, 1.6617)

Average Treatment Effect (Risk Difference): 0.0031 (95% CI: -0.0111 to 0.0172 ) p = 0.671 

Odds Ratio: 1.1 (95% CI: 0.72 to 1.66 ) p = 0.662 

Number Needed to Treat (NNT): 327.1 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  3851    134 0.0348
2         1  1726     47 0.0272


--- HbA1c Mediation Analysis for stroke ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 5577 
Patients with baseline HbA1c data: 5148 
Patients with mean HbA1c data: 4074 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.05 SD: 1.87 
1-Year Mean HbA1c - Mean: 7.61 SD: 1.56 
Correlation between baseline and 1-year mean: 0.753 

Diagnostic after outcome redefinition:
Total patients: 5313 
Total events: 161 

Diagnostic after HbA1c filtering:
Remaining patients: 4928 
Remaining events: 154 
Events by treatment:
   
       0    1
  0 3265  113
  1 1509   41

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
             Estimate Std. Error   t value    Pr(>|t|)
(Intercept)  9.022638 0.13843908  65.17407 0.00000e+00
treatment   -0.682927 0.05256301 -12.99254 8.02493e-38

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                 Estimate Std. Error   z value    Pr(>|z|)
treatment      0.05244563  0.2064747 0.2540051 0.799491580
hba1c_mean_6mo 0.16266961  0.0530730 3.0650162 0.002176582

=== TMLE Mediation Analysis Summary for stroke ===
A path (Treatment → HbA1c): -0.682927 p = 8.02493e-38 
B path (HbA1c → Outcome): 0.1626696 p = 0.002176582 
C path (Direct Effect): 0.05244563 p = 0.7994916 
Indirect Effect (A*B): -0.1110915 p = 0.002853149 (Sobel test)
Total Effect (C + A*B): -0.05864585 

--- HbA1c Mediation Analysis End for stroke ---

========= HbA1c Trajectory Analysis: GLP1 vs SGLT2 - stroke =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.23       3541
2         1                7.65       1607


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                          Estimate  Std. Error       df     t value
(Intercept)            1.256505155 0.036182818 6043.892  34.7265702
baseline_a1c           0.831237303 0.004211711 5926.433 197.3633126
years_since           -0.371671055 0.021147046 4222.634 -17.5755542
treatment             -0.117068183 0.017502867 6388.547  -6.6885148
years_since:treatment -0.009171319 0.037749678 4258.444  -0.2429509
                           Pr(>|t|)
(Intercept)           4.301748e-241
baseline_a1c           0.000000e+00
years_since            8.592823e-67
treatment              2.445681e-11
years_since:treatment  8.080551e-01

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 25814' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 25814)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 25814' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 25814)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 25814' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 25814)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 25814' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 25814)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for stroke (TMLE) ====
                          Estimate  Std. Error      Pr(>|t|)
(Intercept)            1.256505155 0.036182818 4.301748e-241
baseline_a1c           0.831237303 0.004211711  0.000000e+00
years_since           -0.371671055 0.021147046  8.592823e-67
treatment             -0.117068183 0.017502867  2.445681e-11
years_since:treatment -0.009171319 0.037749678  8.080551e-01
# A tibble: 5 × 9
  effect term    estimate std.error statistic    df   p.value conf.low conf.high
  <chr>  <chr>      <dbl>     <dbl>     <dbl> <dbl>     <dbl>    <dbl>     <dbl>
1 fixed  (Inter…  1.26      0.0362     34.7   6044. 4.30e-241   1.19      1.33  
2 fixed  baseli…  0.831     0.00421   197.    5926. 0           0.823     0.839 
3 fixed  years_… -0.372     0.0211    -17.6   4223. 8.59e- 67  -0.413    -0.330 
4 fixed  treatm… -0.117     0.0175     -6.69  6389. 2.45e- 11  -0.151    -0.0828
5 fixed  years_… -0.00917   0.0377     -0.243 4258. 8.08e-  1  -0.0832    0.0648

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  8.023 0.00959 Inf     8.005     8.042
         1  7.906 0.01460 Inf     7.878     7.935

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.652 0.02040 Inf     7.612     7.692
         1  7.525 0.03020 Inf     7.466     7.585

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.280 0.04050 Inf     7.201     7.359
         1  7.145 0.05970 Inf     7.028     7.262

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.117 (p = 2.45e-11 )
Time×Treatment Interaction (HbA1c change over time): -0.009 (p = 0.808 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  3851    134
2         1  1726     47

========= TMLE Analysis: GLP1 vs SU_DPP4 - Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing Epilepsy/Seizure patients: 9746 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 474 
Patients eligible for analysis: 9272 
=======================================
After excluding pre-existing Epilepsy/Seizure patients: 9272 (excluded: 474 patients)
- Input data rows: 9272 
- Patients with outcome dates: 240 
- Outcome date range: 17630 to 19624 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 7785 
- Raw events (before late-onset filter): 172 
- Events after time >= 0 filter: 172 
- Patients filtered out due to event_time < 0: 1056 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 978.8768 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 51                                 172 
No event - administrative censoring 
                               7993 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8216 
Total events: 172 

Index Year Distribution:

2018 2019 2020 2021 
2371 2323 1659 1863 
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SU_DPP4_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.013384
   Estimated Variance:  8.8824e-06
              p-value:  7.0956e-06
    95% Conf Interval:  (0.0075427, 0.019225)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.023631
   Estimated Variance:  4.3139e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.01956, 0.027702)

 Additive Effect
   Parameter Estimate:  -0.010247
   Estimated Variance:  1.3221e-05
              p-value:  0.004829
    95% Conf Interval:  (-0.017374, -0.0031207)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0076865
   Estimated Variance:  1.334e-05
              p-value:  0.035335
    95% Conf Interval:  (-0.014845, -0.00052789)

 Additive Effect among the Controls
   Parameter Estimate:  -0.01228
   Estimated Variance:  1.5006e-05
              p-value:  0.0015241
    95% Conf Interval:  (-0.019872, -0.0046876)

 Relative Risk
   Parameter  Estimate: 0.56637
   Variance(log scale): 0.057387
               p-value: 0.017637
     95% Conf Interval: (0.35415, 0.90576)

 Odds Ratio
   Parameter  Estimate: 0.56049
   Variance(log scale): 0.059123
               p-value: 0.017266
     95% Conf Interval: (0.34801, 0.90269)

Average Treatment Effect (Risk Difference): -0.0102 (95% CI: -0.0174 to -0.0031 ) p = 0.00483 

Odds Ratio: 0.56 (95% CI: 0.35 to 0.9 ) p = 0.0173 

Number Needed to Treat (NNT): 97.6 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  6118    147 0.0240
2         1  2098     25 0.0119


--- HbA1c Mediation Analysis for Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 8216 
Patients with baseline HbA1c data: 7367 
Patients with mean HbA1c data: 5612 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.11 SD: 2.02 
1-Year Mean HbA1c - Mean: 7.71 SD: 1.75 
Correlation between baseline and 1-year mean: 0.762 

Diagnostic after outcome redefinition:
Total patients: 7733 
Total events: 151 

Diagnostic after HbA1c filtering:
Remaining patients: 7006 
Remaining events: 141 
Events by treatment:
   
       0    1
  0 4982  121
  1 1883   20

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
             Estimate Std. Error   t value     Pr(>|t|)
(Intercept)  9.610463 0.12499485  76.88688 0.000000e+00
treatment   -0.677764 0.05028656 -13.47803 9.619643e-41

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                  Estimate Std. Error    z value     Pr(>|z|)
treatment      -0.93728232  0.2829095 -3.3130109 0.0009229739
hba1c_mean_6mo  0.02139562  0.0554068  0.3861552 0.6993817497

=== TMLE Mediation Analysis Summary for Epilepsy/Seizure ===
A path (Treatment → HbA1c): -0.677764 p = 9.619643e-41 
B path (HbA1c → Outcome): 0.02139562 p = 0.6993817 
C path (Direct Effect): -0.9372823 p = 0.0009229739 
Indirect Effect (A*B): -0.01450118 p = 0.6994991 (Sobel test)
Total Effect (C + A*B): -0.9517835 

--- HbA1c Mediation Analysis End for Epilepsy/Seizure ---

========= HbA1c Trajectory Analysis: GLP1 vs SU_DPP4 - Epilepsy/Seizure =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.24       5401
2         1                7.74       1966


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                         Estimate  Std. Error       df    t value     Pr(>|t|)
(Intercept)            1.31322693 0.032199824 8880.202  40.783667 0.000000e+00
baseline_a1c           0.82301568 0.003723522 8697.238 221.031492 0.000000e+00
years_since           -0.32013643 0.020121269 5520.521 -15.910350 9.179364e-56
treatment             -0.09387078 0.017186004 8591.122  -5.462048 4.838201e-08
years_since:treatment -0.06560911 0.036820365 5336.204  -1.781870 7.482727e-02

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 33573' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 33573)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 33573' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 33573)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 33573' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 33573)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 33573' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 33573)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for Epilepsy/Seizure (TMLE) ====
                         Estimate  Std. Error     Pr(>|t|)
(Intercept)            1.31322693 0.032199824 0.000000e+00
baseline_a1c           0.82301568 0.003723522 0.000000e+00
years_since           -0.32013643 0.020121269 9.179364e-56
treatment             -0.09387078 0.017186004 4.838201e-08
years_since:treatment -0.06560911 0.036820365 7.482727e-02
# A tibble: 5 × 9
  effect term     estimate std.error statistic    df  p.value conf.low conf.high
  <chr>  <chr>       <dbl>     <dbl>     <dbl> <dbl>    <dbl>    <dbl>     <dbl>
1 fixed  (Interc…   1.31     0.0322      40.8  8880. 0           1.25    1.38   
2 fixed  baselin…   0.823    0.00372    221.   8697. 0           0.816   0.830  
3 fixed  years_s…  -0.320    0.0201     -15.9  5521. 9.18e-56   -0.360  -0.281  
4 fixed  treatme…  -0.0939   0.0172      -5.46 8591. 4.84e- 8   -0.128  -0.0602 
5 fixed  years_s…  -0.0656   0.0368      -1.78 5336. 7.48e- 2   -0.138   0.00657

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  8.033 0.00916 Inf     8.015     8.051
         1  7.939 0.01450 Inf     7.911     7.968

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.713 0.01940 Inf     7.675     7.751
         1  7.554 0.02980 Inf     7.495     7.612

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.393 0.03840 Inf     7.318     7.468
         1  7.168 0.05890 Inf     7.053     7.283

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.094 (p = 4.84e-08 )
Time×Treatment Interaction (HbA1c change over time): -0.066 (p = 0.0748 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  6118    147
2         1  2098     25

========= TMLE Analysis: GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: TRUE 

Before excluding pre-existing Early-onset Epilepsy/Seizure patients: 9746 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 474 
Patients eligible for analysis: 9272 
=======================================
After excluding pre-existing Early-onset Epilepsy/Seizure patients: 9272 (excluded: 474 patients)
- Input data rows: 9272 
- Patients with outcome dates: 240 
- Outcome date range: 17630 to 19624 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 7785 
- Raw events (before late-onset filter): 172 
- Events after time >= 0 filter: 24 
- Patients filtered out due to event_time < 0: 1056 
- Early-onset applied: events with age < 50: 24 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 978.8768 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 51                                 172 
No event - administrative censoring 
                               7993 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8216 
Total events: 24 

Index Year Distribution:

2018 2019 2020 2021 
2371 2323 1659 1863 
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SU_DPP4_Early-onset_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.0030858
   Estimated Variance:  2.1525e-06
              p-value:  0.035443
    95% Conf Interval:  (0.00021024, 0.0059614)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.0031708
   Estimated Variance:  6.2781e-07
              p-value:  6.2867e-05
    95% Conf Interval:  (0.0016178, 0.0047237)

 Additive Effect
   Parameter Estimate:  -8.4977e-05
   Estimated Variance:  2.9041e-06
              p-value:  0.96023
    95% Conf Interval:  (-0.003425, 0.0032551)

 Additive Effect among the Treated
   Parameter Estimate:  0.00036199
   Estimated Variance:  2.8641e-06
              p-value:  0.83063
    95% Conf Interval:  (-0.002955, 0.003679)

 Additive Effect among the Controls
   Parameter Estimate:  -3.049e-05
   Estimated Variance:  3.1675e-06
              p-value:  0.98633
    95% Conf Interval:  (-0.0035187, 0.0034577)

 Relative Risk
   Parameter  Estimate: 0.9732
   Variance(log scale): 0.30114
               p-value: 0.96052
     95% Conf Interval: (0.33196, 2.8531)

 Odds Ratio
   Parameter  Estimate: 0.97312
   Variance(log scale): 0.30302
               p-value: 0.96052
     95% Conf Interval: (0.33083, 2.8624)

Average Treatment Effect (Risk Difference): -1e-04 (95% CI: -0.0034 to 0.0033 ) p = 0.96 

Odds Ratio: 0.97 (95% CI: 0.33 to 2.86 ) p = 0.961 

Number Needed to Treat (NNT): 11767.9 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events    rate
      <dbl> <int>  <int>   <dbl>
1         0  6118     18 0.00294
2         1  2098      6 0.00286


--- HbA1c Mediation Analysis for Early-onset Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 8216 
Patients with baseline HbA1c data: 7367 
Patients with mean HbA1c data: 5612 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.11 SD: 2.02 
1-Year Mean HbA1c - Mean: 7.71 SD: 1.75 
Correlation between baseline and 1-year mean: 0.762 

Diagnostic after outcome redefinition:
Total patients: 7733 
Total events: 151 

Diagnostic after HbA1c filtering:
Remaining patients: 7006 
Remaining events: 141 
Events by treatment:
   
       0    1
  0 4982  121
  1 1883   20

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
             Estimate Std. Error   t value     Pr(>|t|)
(Intercept)  9.610463 0.12499485  76.88688 0.000000e+00
treatment   -0.677764 0.05028656 -13.47803 9.619643e-41

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                  Estimate Std. Error    z value     Pr(>|z|)
treatment      -0.93728232  0.2829095 -3.3130109 0.0009229739
hba1c_mean_6mo  0.02139562  0.0554068  0.3861552 0.6993817497

=== TMLE Mediation Analysis Summary for Early-onset Epilepsy/Seizure ===
A path (Treatment → HbA1c): -0.677764 p = 9.619643e-41 
B path (HbA1c → Outcome): 0.02139562 p = 0.6993817 
C path (Direct Effect): -0.9372823 p = 0.0009229739 
Indirect Effect (A*B): -0.01450118 p = 0.6994991 (Sobel test)
Total Effect (C + A*B): -0.9517835 

--- HbA1c Mediation Analysis End for Early-onset Epilepsy/Seizure ---

========= HbA1c Trajectory Analysis: GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.24       5401
2         1                7.74       1966


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                         Estimate  Std. Error       df    t value     Pr(>|t|)
(Intercept)            1.31322693 0.032199824 8880.202  40.783667 0.000000e+00
baseline_a1c           0.82301568 0.003723522 8697.238 221.031492 0.000000e+00
years_since           -0.32013643 0.020121269 5520.521 -15.910350 9.179364e-56
treatment             -0.09387078 0.017186004 8591.122  -5.462048 4.838201e-08
years_since:treatment -0.06560911 0.036820365 5336.204  -1.781870 7.482727e-02

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 33573' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 33573)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 33573' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 33573)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 33573' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 33573)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 33573' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 33573)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for Early-onset Epilepsy/Seizure (TMLE) ====
                         Estimate  Std. Error     Pr(>|t|)
(Intercept)            1.31322693 0.032199824 0.000000e+00
baseline_a1c           0.82301568 0.003723522 0.000000e+00
years_since           -0.32013643 0.020121269 9.179364e-56
treatment             -0.09387078 0.017186004 4.838201e-08
years_since:treatment -0.06560911 0.036820365 7.482727e-02
# A tibble: 5 × 9
  effect term     estimate std.error statistic    df  p.value conf.low conf.high
  <chr>  <chr>       <dbl>     <dbl>     <dbl> <dbl>    <dbl>    <dbl>     <dbl>
1 fixed  (Interc…   1.31     0.0322      40.8  8880. 0           1.25    1.38   
2 fixed  baselin…   0.823    0.00372    221.   8697. 0           0.816   0.830  
3 fixed  years_s…  -0.320    0.0201     -15.9  5521. 9.18e-56   -0.360  -0.281  
4 fixed  treatme…  -0.0939   0.0172      -5.46 8591. 4.84e- 8   -0.128  -0.0602 
5 fixed  years_s…  -0.0656   0.0368      -1.78 5336. 7.48e- 2   -0.138   0.00657

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  8.033 0.00916 Inf     8.015     8.051
         1  7.939 0.01450 Inf     7.911     7.968

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.713 0.01940 Inf     7.675     7.751
         1  7.554 0.02980 Inf     7.495     7.612

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.393 0.03840 Inf     7.318     7.468
         1  7.168 0.05890 Inf     7.053     7.283

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.094 (p = 4.84e-08 )
Time×Treatment Interaction (HbA1c change over time): -0.066 (p = 0.0748 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  6118     18
2         1  2098      6

========= TMLE Analysis: GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: TRUE 
- early_onset: FALSE 

Before excluding pre-existing Late-onset Epilepsy/Seizure patients: 9746 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 474 
Patients eligible for analysis: 9272 
=======================================
After excluding pre-existing Late-onset Epilepsy/Seizure patients: 9272 (excluded: 474 patients)
- Input data rows: 9272 
- Patients with outcome dates: 240 
- Outcome date range: 17630 to 19624 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 7785 
- Raw events (before late-onset filter): 172 
- Events after time >= 0 filter: 148 
- Patients filtered out due to event_time < 0: 1056 
- Late-onset applied: events with age >= 50: 148 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 978.8768 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 51                                 172 
No event - administrative censoring 
                               7993 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8216 
Total events: 148 

Index Year Distribution:

2018 2019 2020 2021 
2371 2323 1659 1863 
After age filtering (≥ 50 ): samples = 7141 , events = 146 
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SU_DPP4_Late-onset_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.011366
   Estimated Variance:  9.2858e-06
              p-value:  0.00019143
    95% Conf Interval:  (0.0053939, 0.017339)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.02336
   Estimated Variance:  4.9135e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.019015, 0.027704)

 Additive Effect
   Parameter Estimate:  -0.011993
   Estimated Variance:  1.425e-05
              p-value:  0.0014872
    95% Conf Interval:  (-0.019392, -0.0045948)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0090432
   Estimated Variance:  1.5532e-05
              p-value:  0.021754
    95% Conf Interval:  (-0.016768, -0.001319)

 Additive Effect among the Controls
   Parameter Estimate:  -0.012944
   Estimated Variance:  1.6109e-05
              p-value:  0.0012589
    95% Conf Interval:  (-0.020811, -0.0050781)

 Relative Risk
   Parameter  Estimate: 0.48658
   Variance(log scale): 0.081068
               p-value: 0.011406
     95% Conf Interval: (0.27848, 0.85018)

 Odds Ratio
   Parameter  Estimate: 0.48068
   Variance(log scale): 0.083173
               p-value: 0.011082
     95% Conf Interval: (0.27313, 0.84594)

Average Treatment Effect (Risk Difference): -0.012 (95% CI: -0.0194 to -0.0046 ) p = 0.00149 

Odds Ratio: 0.48 (95% CI: 0.27 to 0.85 ) p = 0.0111 

Number Needed to Treat (NNT): 83.4 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  5377    127 0.0236
2         1  1764     19 0.0108


--- HbA1c Mediation Analysis for Late-onset Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 7141 
Patients with baseline HbA1c data: 6420 
Patients with mean HbA1c data: 4893 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.04 SD: 1.96 
1-Year Mean HbA1c - Mean: 7.65 SD: 1.68 
Correlation between baseline and 1-year mean: 0.755 

Diagnostic after outcome redefinition:
Total patients: 6736 
Total events: 128 

Diagnostic after HbA1c filtering:
Remaining patients: 6118 
Remaining events: 119 
Events by treatment:
   
       0    1
  0 4407  103
  1 1592   16

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
              Estimate Std. Error   t value     Pr(>|t|)
(Intercept) 10.1553929 0.17568092  57.80589 0.000000e+00
treatment   -0.5989181 0.05204947 -11.50671 3.097438e-30

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                  Estimate Std. Error    z value   Pr(>|z|)
treatment      -0.87721462 0.30374520 -2.8879950 0.00387706
hba1c_mean_6mo  0.03891583 0.06150893  0.6326858 0.52693882

=== TMLE Mediation Analysis Summary for Late-onset Epilepsy/Seizure ===
A path (Treatment → HbA1c): -0.5989181 p = 3.097438e-30 
B path (HbA1c → Outcome): 0.03891583 p = 0.5269388 
C path (Direct Effect): -0.8772146 p = 0.00387706 
Indirect Effect (A*B): -0.02330739 p = 0.5275623 (Sobel test)
Total Effect (C + A*B): -0.900522 

--- HbA1c Mediation Analysis End for Late-onset Epilepsy/Seizure ---

========= HbA1c Trajectory Analysis: GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.16       4763
2         1                7.71       1657


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                         Estimate  Std. Error       df    t value      Pr(>|t|)
(Intercept)            1.33763985 0.034119539 7623.706  39.204511 2.019481e-306
baseline_a1c           0.81879932 0.003992724 7437.427 205.072867  0.000000e+00
years_since           -0.31941133 0.020564192 4956.062 -15.532403  3.684767e-53
treatment             -0.08022132 0.017973548 7349.578  -4.463299  8.191094e-06
years_since:treatment -0.05940927 0.038044252 4762.091  -1.561583  1.184527e-01

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 29661' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 29661)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 29661' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 29661)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 29661' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 29661)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 29661' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 29661)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for Late-onset Epilepsy/Seizure (TMLE) ====
                         Estimate  Std. Error      Pr(>|t|)
(Intercept)            1.33763985 0.034119539 2.019481e-306
baseline_a1c           0.81879932 0.003992724  0.000000e+00
years_since           -0.31941133 0.020564192  3.684767e-53
treatment             -0.08022132 0.017973548  8.191094e-06
years_since:treatment -0.05940927 0.038044252  1.184527e-01
# A tibble: 5 × 9
  effect term    estimate std.error statistic    df   p.value conf.low conf.high
  <chr>  <chr>      <dbl>     <dbl>     <dbl> <dbl>     <dbl>    <dbl>     <dbl>
1 fixed  (Inter…   1.34     0.0341      39.2  7624. 2.02e-306    1.27     1.40  
2 fixed  baseli…   0.819    0.00399    205.   7437. 0            0.811    0.827 
3 fixed  years_…  -0.319    0.0206     -15.5  4956. 3.68e- 53   -0.360   -0.279 
4 fixed  treatm…  -0.0802   0.0180      -4.46 7350. 8.19e-  6   -0.115   -0.0450
5 fixed  years_…  -0.0594   0.0380      -1.56 4762. 1.18e-  1   -0.134    0.0152

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.976 0.00947 Inf     7.957     7.995
         1  7.896 0.01520 Inf     7.866     7.926

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.657 0.01980 Inf     7.618     7.695
         1  7.517 0.03090 Inf     7.456     7.578

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.337 0.03920 Inf     7.260     7.414
         1  7.138 0.06110 Inf     7.018     7.258

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.08 (p = 8.19e-06 )
Time×Treatment Interaction (HbA1c change over time): -0.059 (p = 0.118 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  5377    127
2         1  1764     19

========= TMLE Analysis: GLP1 vs SU_DPP4 - ADRD =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: adrd_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing ADRD patients: 9746 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
ADRD diagnosed BEFORE index date (excluding): 263 
Patients eligible for analysis: 9483 
=======================================
After excluding pre-existing ADRD patients: 9483 (excluded: 263 patients)
- Input data rows: 9483 
- Patients with outcome dates: 325 
- Outcome date range: 17618 to 19629 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 7955 
- Raw events (before late-onset filter): 243 
- Events after time >= 0 filter: 243 
- Patients filtered out due to event_time < 0: 1094 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 977.3139 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 57                                 243 
No event - administrative censoring 
                               8089 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8389 
Total events: 243 

Index Year Distribution:

2018 2019 2020 2021 
2439 2358 1712 1880 
Excluding 'dem' covariate for ADRD outcome
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SU_DPP4_ADRD.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.022384
   Estimated Variance:  1.4285e-05
              p-value:  3.1766e-09
    95% Conf Interval:  (0.014976, 0.029792)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.031858
   Estimated Variance:  5.4683e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.027275, 0.036441)

 Additive Effect
   Parameter Estimate:  -0.0094745
   Estimated Variance:  1.9602e-05
              p-value:  0.03236
    95% Conf Interval:  (-0.018152, -0.00079682)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0047027
   Estimated Variance:  1.6292e-05
              p-value:  0.24399
    95% Conf Interval:  (-0.012614, 0.0032085)

 Additive Effect among the Controls
   Parameter Estimate:  -0.011139
   Estimated Variance:  2.3008e-05
              p-value:  0.020225
    95% Conf Interval:  (-0.02054, -0.0017373)

 Relative Risk
   Parameter  Estimate: 0.7026
   Variance(log scale): 0.033688
               p-value: 0.054473
     95% Conf Interval: (0.49032, 1.0068)

 Odds Ratio
   Parameter  Estimate: 0.6958
   Variance(log scale): 0.035357
               p-value: 0.053742
     95% Conf Interval: (0.48131, 1.0059)

Average Treatment Effect (Risk Difference): -0.0095 (95% CI: -0.0182 to -8e-04 ) p = 0.0324 

Odds Ratio: 0.7 (95% CI: 0.48 to 1.01 ) p = 0.0537 

Number Needed to Treat (NNT): 105.5 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  6260    203 0.0324
2         1  2129     40 0.0188


--- HbA1c Mediation Analysis for ADRD ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 8389 
Patients with baseline HbA1c data: 7530 
Patients with mean HbA1c data: 5709 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.1 SD: 2.02 
1-Year Mean HbA1c - Mean: 7.7 SD: 1.75 
Correlation between baseline and 1-year mean: 0.762 

Diagnostic after outcome redefinition:
Total patients: 7897 
Total events: 219 

Diagnostic after HbA1c filtering:
Remaining patients: 7159 
Remaining events: 209 
Events by treatment:
   
       0    1
  0 5052  171
  1 1898   38

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
              Estimate Std. Error   t value     Pr(>|t|)
(Intercept)  9.5847745 0.12376108  77.44579 0.000000e+00
treatment   -0.6877112 0.04982888 -13.80146 1.289213e-42

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                  Estimate Std. Error  z value  Pr(>|z|)
treatment      -0.26736450 0.19699270 -1.35723 0.1747080
hba1c_mean_6mo  0.07017335 0.05089855  1.37869 0.1679902

=== TMLE Mediation Analysis Summary for ADRD ===
A path (Treatment → HbA1c): -0.6877112 p = 1.289213e-42 
B path (HbA1c → Outcome): 0.07017335 p = 0.1679902 
C path (Direct Effect): -0.2673645 p = 0.174708 
Indirect Effect (A*B): -0.048259 p = 0.1701062 (Sobel test)
Total Effect (C + A*B): -0.3156235 

--- HbA1c Mediation Analysis End for ADRD ---

========= HbA1c Trajectory Analysis: GLP1 vs SU_DPP4 - ADRD =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.23       5535
2         1                7.75       1995


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                         Estimate  Std. Error       df    t value     Pr(>|t|)
(Intercept)            1.31187478 0.031748446 9064.559  41.320913 0.000000e+00
baseline_a1c           0.82319038 0.003676419 8870.058 223.910911 0.000000e+00
years_since           -0.31902968 0.019935955 5650.524 -16.002729 2.090799e-56
treatment             -0.09734161 0.016993125 8765.101  -5.728293 1.047950e-08
years_since:treatment -0.06374061 0.036572530 5450.892  -1.742855 8.141536e-02

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 34173' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 34173)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 34173' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 34173)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 34173' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 34173)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 34173' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 34173)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for ADRD (TMLE) ====
                         Estimate  Std. Error     Pr(>|t|)
(Intercept)            1.31187478 0.031748446 0.000000e+00
baseline_a1c           0.82319038 0.003676419 0.000000e+00
years_since           -0.31902968 0.019935955 2.090799e-56
treatment             -0.09734161 0.016993125 1.047950e-08
years_since:treatment -0.06374061 0.036572530 8.141536e-02
# A tibble: 5 × 9
  effect term     estimate std.error statistic    df  p.value conf.low conf.high
  <chr>  <chr>       <dbl>     <dbl>     <dbl> <dbl>    <dbl>    <dbl>     <dbl>
1 fixed  (Interc…   1.31     0.0317      41.3  9065. 0           1.25    1.37   
2 fixed  baselin…   0.823    0.00368    224.   8870. 0           0.816   0.830  
3 fixed  years_s…  -0.319    0.0199     -16.0  5651. 2.09e-56   -0.358  -0.280  
4 fixed  treatme…  -0.0973   0.0170      -5.73 8765. 1.05e- 8   -0.131  -0.0640 
5 fixed  years_s…  -0.0637   0.0366      -1.74 5451. 8.14e- 2   -0.135   0.00796

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  8.031 0.00902 Inf     8.014     8.049
         1  7.934 0.01440 Inf     7.906     7.962

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.712 0.01920 Inf     7.675     7.750
         1  7.551 0.02960 Inf     7.493     7.609

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.393 0.03810 Inf     7.319     7.468
         1  7.169 0.05850 Inf     7.054     7.283

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.097 (p = 1.05e-08 )
Time×Treatment Interaction (HbA1c change over time): -0.064 (p = 0.0814 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  6260    203
2         1  2129     40

========= TMLE Analysis: GLP1 vs SU_DPP4 - stroke =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: stroke_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing stroke patients: 9746 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Stroke diagnosed BEFORE index date (excluding): 747 
Patients eligible for analysis: 8999 
=======================================
After excluding pre-existing stroke patients: 8999 (excluded: 747 patients)
- Input data rows: 8999 
- Patients with outcome dates: 437 
- Outcome date range: 17554 to 19629 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 7541 
- Raw events (before late-onset filter): 315 
- Events after time >= 0 filter: 315 
- Patients filtered out due to event_time < 0: 1030 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 968.8576 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 83                                 315 
No event - administrative censoring 
                               7571 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 7969 
Total events: 315 

Index Year Distribution:

2018 2019 2020 2021 
2340 2232 1604 1793 
Excluding 'cvd' covariate for Stroke outcome
Saved cohort data to bucket: tmle_cohort_GLP1_vs_SU_DPP4_stroke.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.037278
   Estimated Variance:  3.8028e-05
              p-value:  1.4945e-09
    95% Conf Interval:  (0.025191, 0.049364)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.043598
   Estimated Variance:  8.1494e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.038002, 0.049193)

 Additive Effect
   Parameter Estimate:  -0.00632
   Estimated Variance:  4.598e-05
              p-value:  0.35132
    95% Conf Interval:  (-0.01961, 0.0069703)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0065388
   Estimated Variance:  2.8886e-05
              p-value:  0.22374
    95% Conf Interval:  (-0.017073, 0.0039951)

 Additive Effect among the Controls
   Parameter Estimate:  -0.0065923
   Estimated Variance:  6.2958e-05
              p-value:  0.40607
    95% Conf Interval:  (-0.022144, 0.0089592)

 Relative Risk
   Parameter  Estimate: 0.85504
   Variance(log scale): 0.031532
               p-value: 0.37781
     95% Conf Interval: (0.60372, 1.211)

 Odds Ratio
   Parameter  Estimate: 0.84943
   Variance(log scale): 0.034082
               p-value: 0.3767
     95% Conf Interval: (0.59154, 1.2197)

Average Treatment Effect (Risk Difference): -0.0063 (95% CI: -0.0196 to 0.007 ) p = 0.351 

Odds Ratio: 0.85 (95% CI: 0.59 to 1.22 ) p = 0.377 

Number Needed to Treat (NNT): 158.2 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  5949    261 0.0439
2         1  2020     54 0.0267


--- HbA1c Mediation Analysis for stroke ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 7969 
Patients with baseline HbA1c data: 7123 
Patients with mean HbA1c data: 5415 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.11 SD: 2.03 
1-Year Mean HbA1c - Mean: 7.71 SD: 1.76 
Correlation between baseline and 1-year mean: 0.765 

Diagnostic after outcome redefinition:
Total patients: 7478 
Total events: 271 

Diagnostic after HbA1c filtering:
Remaining patients: 6751 
Remaining events: 255 
Events by treatment:
   
       0    1
  0 4714  206
  1 1782   49

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
              Estimate Std. Error   t value     Pr(>|t|)
(Intercept)  9.5663286 0.12662211  75.55022 0.000000e+00
treatment   -0.7154459 0.05145896 -13.90323 3.604549e-43

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                 Estimate Std. Error   z value     Pr(>|z|)
treatment      -0.2295586 0.18043756 -1.272233 2.032903e-01
hba1c_mean_6mo  0.1960042 0.03717256  5.272820 1.343435e-07

=== TMLE Mediation Analysis Summary for stroke ===
A path (Treatment → HbA1c): -0.7154459 p = 3.604549e-43 
B path (HbA1c → Outcome): 0.1960042 p = 1.343435e-07 
C path (Direct Effect): -0.2295586 p = 0.2032903 
Indirect Effect (A*B): -0.1402304 p = 8.215815e-07 (Sobel test)
Total Effect (C + A*B): -0.369789 

--- HbA1c Mediation Analysis End for stroke ---

========= HbA1c Trajectory Analysis: GLP1 vs SU_DPP4 - stroke =========
Rows: 1126922 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl  (2): person_id, A1c
date (1): date_of_measurement

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Baseline HbA1c means (unweighted):
# A tibble: 2 × 3
  treatment unweighted_baseline n_baseline
      <dbl>               <dbl>      <int>
1         0                8.25       5233
2         1                7.73       1890


Linear Mixed Model Results (unweighted, adjusted for baseline HbA1c):
                         Estimate  Std. Error       df    t value      Pr(>|t|)
(Intercept)            1.31411594 0.032708336 8635.281  40.176790 9.881313e-324
baseline_a1c           0.82264727 0.003776817 8439.058 217.814994  0.000000e+00
years_since           -0.32503690 0.020668211 5423.469 -15.726416  1.573496e-54
treatment             -0.10115610 0.017498293 8330.456  -5.780912  7.697419e-09
years_since:treatment -0.04740685 0.037927734 5237.824  -1.249926  2.113825e-01

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 32274' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 32274)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 32274' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 32274)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'pbkrtest.limit = 32274' (or larger)
[or, globally, 'set emm_options(pbkrtest.limit = 32274)' or larger];
but be warned that this may result in large computation time and memory use.

Note: D.f. calculations have been disabled because the number of observations exceeds 3000.
To enable adjustments, add the argument 'lmerTest.limit = 32274' (or larger)
[or, globally, 'set emm_options(lmerTest.limit = 32274)' or larger];
but be warned that this may result in large computation time and memory use.



==== HbA1c Trajectory LMM Results for stroke (TMLE) ====
                         Estimate  Std. Error      Pr(>|t|)
(Intercept)            1.31411594 0.032708336 9.881313e-324
baseline_a1c           0.82264727 0.003776817  0.000000e+00
years_since           -0.32503690 0.020668211  1.573496e-54
treatment             -0.10115610 0.017498293  7.697419e-09
years_since:treatment -0.04740685 0.037927734  2.113825e-01
# A tibble: 5 × 9
  effect term    estimate std.error statistic    df   p.value conf.low conf.high
  <chr>  <chr>      <dbl>     <dbl>     <dbl> <dbl>     <dbl>    <dbl>     <dbl>
1 fixed  (Inter…   1.31     0.0327      40.2  8635. 9.88e-324    1.25     1.38  
2 fixed  baseli…   0.823    0.00378    218.   8439. 0            0.815    0.830 
3 fixed  years_…  -0.325    0.0207     -15.7  5423. 1.57e- 54   -0.366   -0.285 
4 fixed  treatm…  -0.101    0.0175      -5.78 8330. 7.70e-  9   -0.135   -0.0669
5 fixed  years_…  -0.0474   0.0379      -1.25 5238. 2.11e-  1   -0.122    0.0269

Estimated marginal means by time and treatment:
years_since = 0:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  8.038 0.00929 Inf     8.020     8.057
         1  7.937 0.01480 Inf     7.908     7.966

years_since = 1:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.713 0.01990 Inf     7.674     7.752
         1  7.565 0.03070 Inf     7.505     7.625

years_since = 2:
 treatment emmean      SE  df asymp.LCL asymp.UCL
         0  7.388 0.03950 Inf     7.311     7.466
         1  7.192 0.06070 Inf     7.073     7.311

Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 

Treatment Effect (Baseline HbA1c difference): -0.101 (p = 7.7e-09 )
Time×Treatment Interaction (HbA1c change over time): -0.047 (p = 0.211 )

Cohort sizes for HbA1c trajectory analysis:
# A tibble: 2 × 3
  treatment     n events
      <dbl> <int>  <int>
1         0  5949    261
2         1  2020     54

========= TMLE Analysis: SGLT2 vs SU_DPP4 - Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing Epilepsy/Seizure patients: 10384 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 561 
Patients eligible for analysis: 9823 
=======================================
After excluding pre-existing Epilepsy/Seizure patients: 9823 (excluded: 561 patients)
- Input data rows: 9823 
- Patients with outcome dates: 248 
- Outcome date range: 17722 to 19631 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 8192 
- Raw events (before late-onset filter): 180 
- Events after time >= 0 filter: 180 
- Patients filtered out due to event_time < 0: 1208 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 973.5436 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 48                                 180 
No event - administrative censoring 
                               8387 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8615 
Total events: 180 

Index Year Distribution:

2018 2019 2020 2021 
2429 2357 1839 1990 
Saved cohort data to bucket: tmle_cohort_SGLT2_vs_SU_DPP4_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.019414
   Estimated Variance:  6.3779e-06
              p-value:  1.5022e-14
    95% Conf Interval:  (0.014464, 0.024364)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.02294
   Estimated Variance:  5.5198e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.018336, 0.027545)

 Additive Effect
   Parameter Estimate:  -0.0035264
   Estimated Variance:  1.1865e-05
              p-value:  0.30594
    95% Conf Interval:  (-0.010278, 0.0032247)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0034976
   Estimated Variance:  1.3677e-05
              p-value:  0.34428
    95% Conf Interval:  (-0.010746, 0.0037509)

 Additive Effect among the Controls
   Parameter Estimate:  -0.0035415
   Estimated Variance:  1.2811e-05
              p-value:  0.32244
    95% Conf Interval:  (-0.010557, 0.0034737)

 Relative Risk
   Parameter  Estimate: 0.84628
   Variance(log scale): 0.027337
               p-value: 0.31274
     95% Conf Interval: (0.61204, 1.1702)

 Odds Ratio
   Parameter  Estimate: 0.84324
   Variance(log scale): 0.028508
               p-value: 0.31256
     95% Conf Interval: (0.60566, 1.174)

Average Treatment Effect (Risk Difference): -0.0035 (95% CI: -0.0103 to 0.0032 ) p = 0.306 

Odds Ratio: 0.84 (95% CI: 0.61 to 1.17 ) p = 0.313 

Number Needed to Treat (NNT): 283.6 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  5144    117 0.0227
2         1  3471     63 0.0182


--- HbA1c Mediation Analysis for Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 8615 
Patients with baseline HbA1c data: 7774 
Patients with mean HbA1c data: 5928 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.17 SD: 1.96 
1-Year Mean HbA1c - Mean: 7.79 SD: 1.7 
Correlation between baseline and 1-year mean: 0.751 

Diagnostic after outcome redefinition:
Total patients: 8096 
Total events: 162 

Diagnostic after HbA1c filtering:
Remaining patients: 7383 
Remaining events: 152 
Events by treatment:
   
       0    1
  0 4169   95
  1 3062   57

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
               Estimate Std. Error    t value  Pr(>|t|)
(Intercept)  9.62840461 0.12059107 79.8434298 0.0000000
treatment   -0.03389619 0.04390016 -0.7721199 0.4400756

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                  Estimate Std. Error    z value  Pr(>|z|)
treatment      -0.17839352 0.18809039 -0.9484457 0.3429026
hba1c_mean_6mo  0.02718785 0.05312567  0.5117649 0.6088155

=== TMLE Mediation Analysis Summary for Epilepsy/Seizure ===
A path (Treatment → HbA1c): -0.03389619 p = 0.4400756 
B path (HbA1c → Outcome): 0.02718785 p = 0.6088155 
C path (Direct Effect): -0.1783935 p = 0.3429026 
Indirect Effect (A*B): -0.0009215645 p = 0.6696904 (Sobel test)
Total Effect (C + A*B): -0.1793151 

--- HbA1c Mediation Analysis End for Epilepsy/Seizure ---

========= TMLE Analysis: SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: TRUE 

Before excluding pre-existing Early-onset Epilepsy/Seizure patients: 10384 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 561 
Patients eligible for analysis: 9823 
=======================================
After excluding pre-existing Early-onset Epilepsy/Seizure patients: 9823 (excluded: 561 patients)
- Input data rows: 9823 
- Patients with outcome dates: 248 
- Outcome date range: 17722 to 19631 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 8192 
- Raw events (before late-onset filter): 180 
- Events after time >= 0 filter: 21 
- Patients filtered out due to event_time < 0: 1208 
- Early-onset applied: events with age < 50: 21 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 973.5436 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 48                                 180 
No event - administrative censoring 
                               8387 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8615 
Total events: 21 

Index Year Distribution:

2018 2019 2020 2021 
2429 2357 1839 1990 
Saved cohort data to bucket: tmle_cohort_SGLT2_vs_SU_DPP4_Early-onset_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.0025743
   Estimated Variance:  6.2196e-07
              p-value:  0.0010977
    95% Conf Interval:  (0.0010286, 0.00412)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.0024108
   Estimated Variance:  6.0084e-07
              p-value:  0.0018695
    95% Conf Interval:  (0.00089161, 0.0039301)

 Additive Effect
   Parameter Estimate:  0.00016345
   Estimated Variance:  1.2529e-06
              p-value:  0.8839
    95% Conf Interval:  (-0.0020304, 0.0023573)

 Additive Effect among the Treated
   Parameter Estimate:  0.00077837
   Estimated Variance:  1.2983e-06
              p-value:  0.49453
    95% Conf Interval:  (-0.0014549, 0.0030116)

 Additive Effect among the Controls
   Parameter Estimate:  0.00078534
   Estimated Variance:  1.3304e-06
              p-value:  0.49595
    95% Conf Interval:  (-0.0014753, 0.003046)

 Relative Risk
   Parameter  Estimate: 1.0678
   Variance(log scale): 0.20208
               p-value: 0.88398
     95% Conf Interval: (0.44243, 2.5771)

 Odds Ratio
   Parameter  Estimate: 1.068
   Variance(log scale): 0.20309
               p-value: 0.88398
     95% Conf Interval: (0.44153, 2.5832)

Average Treatment Effect (Risk Difference): 2e-04 (95% CI: -0.002 to 0.0024 ) p = 0.884 

Odds Ratio: 1.07 (95% CI: 0.44 to 2.58 ) p = 0.884 

Number Needed to Treat (NNT): 6118.3 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events    rate
      <dbl> <int>  <int>   <dbl>
1         0  5144     14 0.00272
2         1  3471      7 0.00202


--- HbA1c Mediation Analysis for Early-onset Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 8615 
Patients with baseline HbA1c data: 7774 
Patients with mean HbA1c data: 5928 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.17 SD: 1.96 
1-Year Mean HbA1c - Mean: 7.79 SD: 1.7 
Correlation between baseline and 1-year mean: 0.751 

Diagnostic after outcome redefinition:
Total patients: 8096 
Total events: 162 

Diagnostic after HbA1c filtering:
Remaining patients: 7383 
Remaining events: 152 
Events by treatment:
   
       0    1
  0 4169   95
  1 3062   57

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
               Estimate Std. Error    t value  Pr(>|t|)
(Intercept)  9.62840461 0.12059107 79.8434298 0.0000000
treatment   -0.03389619 0.04390016 -0.7721199 0.4400756

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                  Estimate Std. Error    z value  Pr(>|z|)
treatment      -0.17839352 0.18809039 -0.9484457 0.3429026
hba1c_mean_6mo  0.02718785 0.05312567  0.5117649 0.6088155

=== TMLE Mediation Analysis Summary for Early-onset Epilepsy/Seizure ===
A path (Treatment → HbA1c): -0.03389619 p = 0.4400756 
B path (HbA1c → Outcome): 0.02718785 p = 0.6088155 
C path (Direct Effect): -0.1783935 p = 0.3429026 
Indirect Effect (A*B): -0.0009215645 p = 0.6696904 (Sobel test)
Total Effect (C + A*B): -0.1793151 

--- HbA1c Mediation Analysis End for Early-onset Epilepsy/Seizure ---

========= TMLE Analysis: SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: epilepsy_or_seizure_start_date 
- data_cut_date: 2023-10-01 
- late_onset: TRUE 
- early_onset: FALSE 

Before excluding pre-existing Late-onset Epilepsy/Seizure patients: 10384 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Epilepsy/Seizure diagnosed BEFORE index date (excluding): 561 
Patients eligible for analysis: 9823 
=======================================
After excluding pre-existing Late-onset Epilepsy/Seizure patients: 9823 (excluded: 561 patients)
- Input data rows: 9823 
- Patients with outcome dates: 248 
- Outcome date range: 17722 to 19631 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 8192 
- Raw events (before late-onset filter): 180 
- Events after time >= 0 filter: 159 
- Patients filtered out due to event_time < 0: 1208 
- Late-onset applied: events with age >= 50: 159 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 973.5436 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 48                                 180 
No event - administrative censoring 
                               8387 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8615 
Total events: 159 

Index Year Distribution:

2018 2019 2020 2021 
2429 2357 1839 1990 
After age filtering (≥ 50 ): samples = 7577 , events = 156 
Saved cohort data to bucket: tmle_cohort_SGLT2_vs_SU_DPP4_Late-onset_Epilepsy_Seizure.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.018506
   Estimated Variance:  6.6719e-06
              p-value:  7.8022e-13
    95% Conf Interval:  (0.013444, 0.023569)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.022787
   Estimated Variance:  6.382e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.017836, 0.027739)

 Additive Effect
   Parameter Estimate:  -0.0042811
   Estimated Variance:  1.3063e-05
              p-value:  0.23622
    95% Conf Interval:  (-0.011365, 0.0028027)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0057271
   Estimated Variance:  1.5722e-05
              p-value:  0.14863
    95% Conf Interval:  (-0.013499, 0.0020443)

 Additive Effect among the Controls
   Parameter Estimate:  -0.0051634
   Estimated Variance:  1.3602e-05
              p-value:  0.1615
    95% Conf Interval:  (-0.012392, 0.002065)

 Relative Risk
   Parameter  Estimate: 0.81213
   Variance(log scale): 0.031793
               p-value: 0.24318
     95% Conf Interval: (0.5726, 1.1519)

 Odds Ratio
   Parameter  Estimate: 0.80859
   Variance(log scale): 0.033116
               p-value: 0.24299
     95% Conf Interval: (0.56601, 1.1551)

Average Treatment Effect (Risk Difference): -0.0043 (95% CI: -0.0114 to 0.0028 ) p = 0.236 

Odds Ratio: 0.81 (95% CI: 0.57 to 1.16 ) p = 0.243 

Number Needed to Treat (NNT): 233.6 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  4480    101 0.0225
2         1  3097     55 0.0178


--- HbA1c Mediation Analysis for Late-onset Epilepsy/Seizure ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 7577 
Patients with baseline HbA1c data: 6866 
Patients with mean HbA1c data: 5245 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.1 SD: 1.9 
1-Year Mean HbA1c - Mean: 7.73 SD: 1.64 
Correlation between baseline and 1-year mean: 0.748 

Diagnostic after outcome redefinition:
Total patients: 7141 
Total events: 141 

Diagnostic after HbA1c filtering:
Remaining patients: 6538 
Remaining events: 132 
Events by treatment:
   
       0    1
  0 3659   81
  1 2747   51

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
               Estimate Std. Error    t value  Pr(>|t|)
(Intercept) 10.12190932  0.1675664 60.4053620 0.0000000
treatment    0.01444315  0.0448339  0.3221481 0.7473539

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                 Estimate Std. Error    z value  Pr(>|z|)
treatment      -0.1566039 0.20056060 -0.7808309 0.4349019
hba1c_mean_6mo  0.0519878 0.05735113  0.9064825 0.3646805

=== TMLE Mediation Analysis Summary for Late-onset Epilepsy/Seizure ===
A path (Treatment → HbA1c): 0.01444315 p = 0.7473539 
B path (HbA1c → Outcome): 0.0519878 p = 0.3646805 
C path (Direct Effect): -0.1566039 p = 0.4349019 
Indirect Effect (A*B): 0.0007508677 p = 0.7614714 (Sobel test)
Total Effect (C + A*B): -0.1558531 

--- HbA1c Mediation Analysis End for Late-onset Epilepsy/Seizure ---

========= TMLE Analysis: SGLT2 vs SU_DPP4 - ADRD =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: adrd_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing ADRD patients: 10384 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
ADRD diagnosed BEFORE index date (excluding): 315 
Patients eligible for analysis: 10069 
=======================================
After excluding pre-existing ADRD patients: 10069 (excluded: 315 patients)
- Input data rows: 10069 
- Patients with outcome dates: 373 
- Outcome date range: 17618 to 19619 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 8386 
- Raw events (before late-onset filter): 286 
- Events after time >= 0 filter: 286 
- Patients filtered out due to event_time < 0: 1253 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 971.5911 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 61                                 286 
No event - administrative censoring 
                               8469 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8816 
Total events: 286 

Index Year Distribution:

2018 2019 2020 2021 
2513 2408 1869 2026 
Excluding 'dem' covariate for ADRD outcome
Saved cohort data to bucket: tmle_cohort_SGLT2_vs_SU_DPP4_ADRD.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.034649
   Estimated Variance:  1.0083e-05
              p-value:  <2e-16
    95% Conf Interval:  (0.028425, 0.040873)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.035608
   Estimated Variance:  8.3874e-06
              p-value:  <2e-16
    95% Conf Interval:  (0.029932, 0.041284)

 Additive Effect
   Parameter Estimate:  -0.00095905
   Estimated Variance:  1.8161e-05
              p-value:  0.82194
    95% Conf Interval:  (-0.0093116, 0.0073935)

 Additive Effect among the Treated
   Parameter Estimate:  -0.0027843
   Estimated Variance:  2.2717e-05
              p-value:  0.5591
    95% Conf Interval:  (-0.012126, 0.0065574)

 Additive Effect among the Controls
   Parameter Estimate:  0.00020801
   Estimated Variance:  1.7644e-05
              p-value:  0.9605
    95% Conf Interval:  (-0.0080248, 0.0084408)

 Relative Risk
   Parameter  Estimate: 0.97307
   Variance(log scale): 0.014763
               p-value: 0.82221
     95% Conf Interval: (0.76686, 1.2347)

 Odds Ratio
   Parameter  Estimate: 0.9721
   Variance(log scale): 0.015856
               p-value: 0.8222
     95% Conf Interval: (0.7595, 1.2442)

Average Treatment Effect (Risk Difference): -0.001 (95% CI: -0.0093 to 0.0074 ) p = 0.822 

Odds Ratio: 0.97 (95% CI: 0.76 to 1.24 ) p = 0.822 

Number Needed to Treat (NNT): 1042.7 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  5281    170 0.0322
2         1  3535    116 0.0328


--- HbA1c Mediation Analysis for ADRD ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 8816 
Patients with baseline HbA1c data: 7969 
Patients with mean HbA1c data: 6052 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.17 SD: 1.97 
1-Year Mean HbA1c - Mean: 7.8 SD: 1.7 
Correlation between baseline and 1-year mean: 0.75 

Diagnostic after outcome redefinition:
Total patients: 8283 
Total events: 257 

Diagnostic after HbA1c filtering:
Remaining patients: 7562 
Remaining events: 249 
Events by treatment:
   
       0    1
  0 4238  139
  1 3075  110

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
              Estimate Std. Error  t value  Pr(>|t|)
(Intercept)  9.6075804 0.11959667 80.33318 0.0000000
treatment   -0.0234757 0.04359866 -0.53845 0.5902871

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                 Estimate Std. Error  z value  Pr(>|z|)
treatment      0.14852026 0.14572272 1.019198 0.3081091
hba1c_mean_6mo 0.07181704 0.04639827 1.547839 0.1216611

=== TMLE Mediation Analysis Summary for ADRD ===
A path (Treatment → HbA1c): -0.0234757 p = 0.5902871 
B path (HbA1c → Outcome): 0.07181704 p = 0.1216611 
C path (Direct Effect): 0.1485203 p = 0.3081091 
Indirect Effect (A*B): -0.001685955 p = 0.6110627 (Sobel test)
Total Effect (C + A*B): 0.1468343 

--- HbA1c Mediation Analysis End for ADRD ---

========= TMLE Analysis: SGLT2 vs SU_DPP4 - stroke =========

--- DEBUG followup_and_event function ---
Input parameters:
- outcome_var: stroke_start_date 
- data_cut_date: 2023-10-01 
- late_onset: FALSE 
- early_onset: FALSE 

Before excluding pre-existing stroke patients: 10384 

=== DEBUGGING DATE-BASED EXCLUSIONS (TMLE) ===
Stroke diagnosed BEFORE index date (excluding): 899 
Patients eligible for analysis: 9485 
=======================================
After excluding pre-existing stroke patients: 9485 (excluded: 899 patients)
- Input data rows: 9485 
- Patients with outcome dates: 462 
- Outcome date range: 17554 to 19629 

DEBUG intermediate calculations:
- Crossover dates available: 0 
- EHR end dates available: 7888 
- Raw events (before late-onset filter): 334 
- Events after time >= 0 filter: 334 
- Patients filtered out due to event_time < 0: 1173 

Event time distribution:
- Min event_time: 0 
- Max event_time: 2098 
- Mean event_time: 965.4506 

Censoring reasons:

              Event after censoring                      Event occurred 
                                 86                                 334 
No event - administrative censoring 
                               7892 
--- END DEBUG followup_and_event ---


Total sample size before TMLE: 8312 
Total events: 334 

Index Year Distribution:

2018 2019 2020 2021 
2400 2270 1755 1887 
Excluding 'cvd' covariate for Stroke outcome
Saved cohort data to bucket: tmle_cohort_SGLT2_vs_SU_DPP4_stroke.csv 

TMLE Results:
 Marginal mean under treatment (EY1)
   Parameter Estimate:  0.036483
   Estimated Variance:  1.2573e-05
              p-value:  <2e-16
    95% Conf Interval:  (0.029534, 0.043433)

 Marginal mean under comparator (EY0)
   Parameter Estimate:  0.048112
   Estimated Variance:  1.1955e-05
              p-value:  <2e-16
    95% Conf Interval:  (0.041335, 0.054888)

 Additive Effect
   Parameter Estimate:  -0.011628
   Estimated Variance:  2.4393e-05
              p-value:  0.018553
    95% Conf Interval:  (-0.021308, -0.0019481)

 Additive Effect among the Treated
   Parameter Estimate:  -0.01414
   Estimated Variance:  3.0315e-05
              p-value:  0.010225
    95% Conf Interval:  (-0.024931, -0.0033485)

 Additive Effect among the Controls
   Parameter Estimate:  -0.009944
   Estimated Variance:  2.5478e-05
              p-value:  0.048834
    95% Conf Interval:  (-0.019837, -5.0865e-05)

 Relative Risk
   Parameter  Estimate: 0.75831
   Variance(log scale): 0.014534
               p-value: 0.021739
     95% Conf Interval: (0.59873, 0.96043)

 Odds Ratio
   Parameter  Estimate: 0.74916
   Variance(log scale): 0.015791
               p-value: 0.021546
     95% Conf Interval: (0.58561, 0.95838)

Average Treatment Effect (Risk Difference): -0.0116 (95% CI: -0.0213 to -0.0019 ) p = 0.0186 

Odds Ratio: 0.75 (95% CI: 0.59 to 0.96 ) p = 0.0215 

Number Needed to Treat (NNT): 86 

Observed Event Rates:
# A tibble: 2 × 4
  treatment     n events   rate
      <dbl> <int>  <int>  <dbl>
1         0  5028    221 0.0440
2         1  3284    113 0.0344


--- HbA1c Mediation Analysis for stroke ---

Calculating 1-year weighted mean HbA1c for mediation analysis
Total patients in TMLE cohort: 8312 
Patients with baseline HbA1c data: 7479 
Patients with mean HbA1c data: 5675 

--- HbA1c Distribution Comparison (TMLE) ---
Baseline HbA1c - Mean: 8.18 SD: 1.98 
1-Year Mean HbA1c - Mean: 7.8 SD: 1.71 
Correlation between baseline and 1-year mean: 0.751 

Diagnostic after outcome redefinition:
Total patients: 7781 
Total events: 285 

Diagnostic after HbA1c filtering:
Remaining patients: 7074 
Remaining events: 271 
Events by treatment:
   
       0    1
  0 3963  172
  1 2840   99

Mediation with TMLE approach:

Mediator model formula: hba1c_mean_6mo ~ treatment + age + sex_cat + raceethnicity_cat 
Mediator model success!

Mediator summary:
               Estimate Std. Error   t value  Pr(>|t|)
(Intercept)  9.64889146 0.12281019 78.567517 0.0000000
treatment   -0.06654938 0.04528806 -1.469468 0.1417639

Outcome model formula: event ~ treatment + hba1c_mean_6mo + age + sex_cat + raceethnicity_cat 
Outcome model success!

Outcome summary:
                  Estimate Std. Error   z value   Pr(>|z|)
treatment      -0.21471350 0.14753011 -1.455388 0.14556198
hba1c_mean_6mo  0.08955757 0.04094656  2.187182 0.02872925

=== TMLE Mediation Analysis Summary for stroke ===
A path (Treatment → HbA1c): -0.06654938 p = 0.1417639 
B path (HbA1c → Outcome): 0.08955757 p = 0.02872925 
C path (Direct Effect): -0.2147135 p = 0.145562 
Indirect Effect (A*B): -0.00596 p = 0.2225623 (Sobel test)
Total Effect (C + A*B): -0.2206735 

--- HbA1c Mediation Analysis End for stroke ---

=== TMLE Mediation Analysis Summary Table ===
                                                  method       comparison
GLP1 vs SGLT2 - Epilepsy/Seizure.1                  TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Epilepsy/Seizure.2                  TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Epilepsy/Seizure.3                  TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Epilepsy/Seizure.4                  TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1      TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2      TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3      TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4      TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1       TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2       TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3       TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4       TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - ADRD.1                              TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - ADRD.2                              TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - ADRD.3                              TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - ADRD.4                              TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - stroke.1                            TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - stroke.2                            TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - stroke.3                            TMLE    GLP1 vs SGLT2
GLP1 vs SGLT2 - stroke.4                            TMLE    GLP1 vs SGLT2
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1                TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2                TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3                TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4                TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1    TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2    TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3    TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4    TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1     TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2     TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3     TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4     TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - ADRD.1                            TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - ADRD.2                            TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - ADRD.3                            TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - ADRD.4                            TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - stroke.1                          TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - stroke.2                          TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - stroke.3                          TMLE  GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - stroke.4                          TMLE  GLP1 vs SU_DPP4
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1               TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2               TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3               TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4               TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1   TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2   TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3   TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4   TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1    TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2    TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3    TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4    TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - ADRD.1                           TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - ADRD.2                           TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - ADRD.3                           TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - ADRD.4                           TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - stroke.1                         TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - stroke.2                         TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - stroke.3                         TMLE SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - stroke.4                         TMLE SGLT2 vs SU_DPP4
                                                                       outcome
GLP1 vs SGLT2 - Epilepsy/Seizure.1                            Epilepsy/Seizure
GLP1 vs SGLT2 - Epilepsy/Seizure.2                            Epilepsy/Seizure
GLP1 vs SGLT2 - Epilepsy/Seizure.3                            Epilepsy/Seizure
GLP1 vs SGLT2 - Epilepsy/Seizure.4                            Epilepsy/Seizure
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1    Early-onset Epilepsy/Seizure
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2    Early-onset Epilepsy/Seizure
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3    Early-onset Epilepsy/Seizure
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4    Early-onset Epilepsy/Seizure
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1      Late-onset Epilepsy/Seizure
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2      Late-onset Epilepsy/Seizure
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3      Late-onset Epilepsy/Seizure
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4      Late-onset Epilepsy/Seizure
GLP1 vs SGLT2 - ADRD.1                                                    ADRD
GLP1 vs SGLT2 - ADRD.2                                                    ADRD
GLP1 vs SGLT2 - ADRD.3                                                    ADRD
GLP1 vs SGLT2 - ADRD.4                                                    ADRD
GLP1 vs SGLT2 - stroke.1                                                stroke
GLP1 vs SGLT2 - stroke.2                                                stroke
GLP1 vs SGLT2 - stroke.3                                                stroke
GLP1 vs SGLT2 - stroke.4                                                stroke
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1                          Epilepsy/Seizure
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2                          Epilepsy/Seizure
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3                          Epilepsy/Seizure
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4                          Epilepsy/Seizure
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1  Early-onset Epilepsy/Seizure
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2  Early-onset Epilepsy/Seizure
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3  Early-onset Epilepsy/Seizure
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  Early-onset Epilepsy/Seizure
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1    Late-onset Epilepsy/Seizure
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2    Late-onset Epilepsy/Seizure
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3    Late-onset Epilepsy/Seizure
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4    Late-onset Epilepsy/Seizure
GLP1 vs SU_DPP4 - ADRD.1                                                  ADRD
GLP1 vs SU_DPP4 - ADRD.2                                                  ADRD
GLP1 vs SU_DPP4 - ADRD.3                                                  ADRD
GLP1 vs SU_DPP4 - ADRD.4                                                  ADRD
GLP1 vs SU_DPP4 - stroke.1                                              stroke
GLP1 vs SU_DPP4 - stroke.2                                              stroke
GLP1 vs SU_DPP4 - stroke.3                                              stroke
GLP1 vs SU_DPP4 - stroke.4                                              stroke
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1                         Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2                         Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3                         Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4                         Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1 Early-onset Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2 Early-onset Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3 Early-onset Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4 Early-onset Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1   Late-onset Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2   Late-onset Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3   Late-onset Epilepsy/Seizure
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   Late-onset Epilepsy/Seizure
SGLT2 vs SU_DPP4 - ADRD.1                                                 ADRD
SGLT2 vs SU_DPP4 - ADRD.2                                                 ADRD
SGLT2 vs SU_DPP4 - ADRD.3                                                 ADRD
SGLT2 vs SU_DPP4 - ADRD.4                                                 ADRD
SGLT2 vs SU_DPP4 - stroke.1                                             stroke
SGLT2 vs SU_DPP4 - stroke.2                                             stroke
SGLT2 vs SU_DPP4 - stroke.3                                             stroke
SGLT2 vs SU_DPP4 - stroke.4                                             stroke
                                                                                                              effect
GLP1 vs SGLT2 - Epilepsy/Seizure.1                Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - Epilepsy/Seizure.2                                                      Direct Effect of Semaglutide
GLP1 vs SGLT2 - Epilepsy/Seizure.3                                                 Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - Epilepsy/Seizure.4                                                        A Path (Treatment → HbA1c)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1    Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2                                          Direct Effect of Semaglutide
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3                                     Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4                                            A Path (Treatment → HbA1c)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1     Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2                                           Direct Effect of Semaglutide
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3                                      Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4                                             A Path (Treatment → HbA1c)
GLP1 vs SGLT2 - ADRD.1                            Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - ADRD.2                                                                  Direct Effect of Semaglutide
GLP1 vs SGLT2 - ADRD.3                                                             Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - ADRD.4                                                                    A Path (Treatment → HbA1c)
GLP1 vs SGLT2 - stroke.1                          Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - stroke.2                                                                Direct Effect of Semaglutide
GLP1 vs SGLT2 - stroke.3                                                           Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - stroke.4                                                                  A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1              Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2                                                    Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3                                               Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4                                                      A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1  Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2                                        Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3                                   Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4                                          A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1   Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2                                         Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3                                    Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4                                           A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - ADRD.1                          Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - ADRD.2                                                                Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - ADRD.3                                                           Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - ADRD.4                                                                  A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - stroke.1                        Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - stroke.2                                                              Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - stroke.3                                                         Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - stroke.4                                                                A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1             Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2                                                   Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3                                              Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4                                                     A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1 Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2                                       Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3                                  Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4                                         A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1  Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2                                        Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3                                   Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4                                          A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - ADRD.1                         Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - ADRD.2                                                               Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - ADRD.3                                                          Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - ADRD.4                                                                 A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - stroke.1                       Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - stroke.2                                                             Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - stroke.3                                                        Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - stroke.4                                                               A Path (Treatment → HbA1c)
                                                     beta     se
GLP1 vs SGLT2 - Epilepsy/Seizure.1                -0.9890 0.3527
GLP1 vs SGLT2 - Epilepsy/Seizure.2                -0.8833 0.3496
GLP1 vs SGLT2 - Epilepsy/Seizure.3                -0.1057 0.0467
GLP1 vs SGLT2 - Epilepsy/Seizure.4                -0.6831 0.0514
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1    -0.9890 0.3527
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2    -0.8833 0.3496
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3    -0.1057 0.0467
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4    -0.6831 0.0514
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1     -1.0332 0.3896
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2     -0.9653 0.3864
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3     -0.0680 0.0498
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4     -0.6451 0.0532
GLP1 vs SGLT2 - ADRD.1                            -0.5388 0.2423
GLP1 vs SGLT2 - ADRD.2                            -0.4372 0.2388
GLP1 vs SGLT2 - ADRD.3                            -0.1017 0.0408
GLP1 vs SGLT2 - ADRD.4                            -0.6903 0.0511
GLP1 vs SGLT2 - stroke.1                          -0.0586 0.2098
GLP1 vs SGLT2 - stroke.2                           0.0524 0.2065
GLP1 vs SGLT2 - stroke.3                          -0.1111 0.0372
GLP1 vs SGLT2 - stroke.4                          -0.6829 0.0526
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1              -0.9518 0.2854
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2              -0.9373 0.2829
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3              -0.0145 0.0376
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4              -0.6778 0.0503
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1  -0.9518 0.2854
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2  -0.9373 0.2829
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3  -0.0145 0.0376
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  -0.6778 0.0503
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1   -0.9005 0.3060
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2   -0.8772 0.3037
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3   -0.0233 0.0369
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   -0.5989 0.0520
GLP1 vs SU_DPP4 - ADRD.1                          -0.3156 0.2001
GLP1 vs SU_DPP4 - ADRD.2                          -0.2674 0.1970
GLP1 vs SU_DPP4 - ADRD.3                          -0.0483 0.0352
GLP1 vs SU_DPP4 - ADRD.4                          -0.6877 0.0498
GLP1 vs SU_DPP4 - stroke.1                        -0.3698 0.1827
GLP1 vs SU_DPP4 - stroke.2                        -0.2296 0.1804
GLP1 vs SU_DPP4 - stroke.3                        -0.1402 0.0284
GLP1 vs SU_DPP4 - stroke.4                        -0.7154 0.0515
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1             -0.1793 0.1881
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2             -0.1784 0.1881
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3             -0.0009 0.0022
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4             -0.0339 0.0439
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1 -0.1793 0.1881
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2 -0.1784 0.1881
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3 -0.0009 0.0022
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4 -0.0339 0.0439
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1  -0.1559 0.2006
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2  -0.1566 0.2006
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3   0.0008 0.0025
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   0.0144 0.0448
SGLT2 vs SU_DPP4 - ADRD.1                          0.1468 0.1458
SGLT2 vs SU_DPP4 - ADRD.2                          0.1485 0.1457
SGLT2 vs SU_DPP4 - ADRD.3                         -0.0017 0.0033
SGLT2 vs SU_DPP4 - ADRD.4                         -0.0235 0.0436
SGLT2 vs SU_DPP4 - stroke.1                       -0.2207 0.1476
SGLT2 vs SU_DPP4 - stroke.2                       -0.2147 0.1475
SGLT2 vs SU_DPP4 - stroke.3                       -0.0060 0.0049
SGLT2 vs SU_DPP4 - stroke.4                       -0.0665 0.0453
                                                           beta_se    hr
GLP1 vs SGLT2 - Epilepsy/Seizure.1                -0.9890 (0.3527) 0.372
GLP1 vs SGLT2 - Epilepsy/Seizure.2                -0.8833 (0.3496) 0.413
GLP1 vs SGLT2 - Epilepsy/Seizure.3                -0.1057 (0.0467) 0.900
GLP1 vs SGLT2 - Epilepsy/Seizure.4                -0.6831 (0.0514)   N/A
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1    -0.9890 (0.3527) 0.372
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2    -0.8833 (0.3496) 0.413
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3    -0.1057 (0.0467) 0.900
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4    -0.6831 (0.0514)   N/A
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1     -1.0332 (0.3896) 0.356
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2     -0.9653 (0.3864) 0.381
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3     -0.0680 (0.0498) 0.934
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4     -0.6451 (0.0532)   N/A
GLP1 vs SGLT2 - ADRD.1                            -0.5388 (0.2423) 0.583
GLP1 vs SGLT2 - ADRD.2                            -0.4372 (0.2388) 0.646
GLP1 vs SGLT2 - ADRD.3                            -0.1017 (0.0408) 0.903
GLP1 vs SGLT2 - ADRD.4                            -0.6903 (0.0511)   N/A
GLP1 vs SGLT2 - stroke.1                          -0.0586 (0.2098) 0.943
GLP1 vs SGLT2 - stroke.2                           0.0524 (0.2065) 1.054
GLP1 vs SGLT2 - stroke.3                          -0.1111 (0.0372) 0.895
GLP1 vs SGLT2 - stroke.4                          -0.6829 (0.0526)   N/A
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1              -0.9518 (0.2854) 0.386
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2              -0.9373 (0.2829) 0.392
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3              -0.0145 (0.0376) 0.986
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4              -0.6778 (0.0503)   N/A
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1  -0.9518 (0.2854) 0.386
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2  -0.9373 (0.2829) 0.392
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3  -0.0145 (0.0376) 0.986
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  -0.6778 (0.0503)   N/A
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1   -0.9005 (0.3060) 0.406
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2   -0.8772 (0.3037) 0.416
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3   -0.0233 (0.0369) 0.977
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   -0.5989 (0.0520)   N/A
GLP1 vs SU_DPP4 - ADRD.1                          -0.3156 (0.2001) 0.729
GLP1 vs SU_DPP4 - ADRD.2                          -0.2674 (0.1970) 0.765
GLP1 vs SU_DPP4 - ADRD.3                          -0.0483 (0.0352) 0.953
GLP1 vs SU_DPP4 - ADRD.4                          -0.6877 (0.0498)   N/A
GLP1 vs SU_DPP4 - stroke.1                        -0.3698 (0.1827) 0.691
GLP1 vs SU_DPP4 - stroke.2                        -0.2296 (0.1804) 0.795
GLP1 vs SU_DPP4 - stroke.3                        -0.1402 (0.0284) 0.869
GLP1 vs SU_DPP4 - stroke.4                        -0.7154 (0.0515)   N/A
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1             -0.1793 (0.1881) 0.836
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2             -0.1784 (0.1881) 0.837
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3             -0.0009 (0.0022) 0.999
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4             -0.0339 (0.0439)   N/A
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1 -0.1793 (0.1881) 0.836
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2 -0.1784 (0.1881) 0.837
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3 -0.0009 (0.0022) 0.999
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4 -0.0339 (0.0439)   N/A
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1  -0.1559 (0.2006) 0.856
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2  -0.1566 (0.2006) 0.855
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3   0.0008 (0.0025) 1.001
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   0.0144 (0.0448)   N/A
SGLT2 vs SU_DPP4 - ADRD.1                          0.1468 (0.1458) 1.158
SGLT2 vs SU_DPP4 - ADRD.2                          0.1485 (0.1457) 1.160
SGLT2 vs SU_DPP4 - ADRD.3                         -0.0017 (0.0033) 0.998
SGLT2 vs SU_DPP4 - ADRD.4                         -0.0235 (0.0436)   N/A
SGLT2 vs SU_DPP4 - stroke.1                       -0.2207 (0.1476) 0.802
SGLT2 vs SU_DPP4 - stroke.2                       -0.2147 (0.1475) 0.807
SGLT2 vs SU_DPP4 - stroke.3                       -0.0060 (0.0049) 0.994
SGLT2 vs SU_DPP4 - stroke.4                       -0.0665 (0.0453)   N/A
                                                  hr_lower hr_upper
GLP1 vs SGLT2 - Epilepsy/Seizure.1                   0.186    0.743
GLP1 vs SGLT2 - Epilepsy/Seizure.2                   0.208    0.820
GLP1 vs SGLT2 - Epilepsy/Seizure.3                   0.821    0.986
GLP1 vs SGLT2 - Epilepsy/Seizure.4                     N/A      N/A
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1       0.186    0.743
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2       0.208    0.820
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3       0.821    0.986
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4         N/A      N/A
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1        0.166    0.764
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2        0.179    0.812
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3        0.847    1.030
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4          N/A      N/A
GLP1 vs SGLT2 - ADRD.1                               0.363    0.938
GLP1 vs SGLT2 - ADRD.2                               0.404    1.031
GLP1 vs SGLT2 - ADRD.3                               0.834    0.978
GLP1 vs SGLT2 - ADRD.4                                 N/A      N/A
GLP1 vs SGLT2 - stroke.1                             0.625    1.423
GLP1 vs SGLT2 - stroke.2                             0.703    1.580
GLP1 vs SGLT2 - stroke.3                             0.832    0.963
GLP1 vs SGLT2 - stroke.4                               N/A      N/A
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1                 0.221    0.675
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2                 0.225    0.682
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3                 0.916    1.061
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4                   N/A      N/A
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1     0.221    0.675
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2     0.225    0.682
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3     0.916    1.061
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4       N/A      N/A
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1      0.223    0.740
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2      0.229    0.754
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3      0.909    1.050
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4        N/A      N/A
GLP1 vs SU_DPP4 - ADRD.1                             0.493    1.080
GLP1 vs SU_DPP4 - ADRD.2                             0.520    1.126
GLP1 vs SU_DPP4 - ADRD.3                             0.889    1.021
GLP1 vs SU_DPP4 - ADRD.4                               N/A      N/A
GLP1 vs SU_DPP4 - stroke.1                           0.483    0.988
GLP1 vs SU_DPP4 - stroke.2                           0.558    1.132
GLP1 vs SU_DPP4 - stroke.3                           0.822    0.919
GLP1 vs SU_DPP4 - stroke.4                             N/A      N/A
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1                0.578    1.208
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2                0.579    1.210
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3                0.995    1.003
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4                  N/A      N/A
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1    0.578    1.208
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2    0.579    1.210
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3    0.995    1.003
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4      N/A      N/A
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1     0.578    1.268
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2     0.577    1.267
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3     0.996    1.006
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4       N/A      N/A
SGLT2 vs SU_DPP4 - ADRD.1                            0.870    1.541
SGLT2 vs SU_DPP4 - ADRD.2                            0.872    1.544
SGLT2 vs SU_DPP4 - ADRD.3                            0.992    1.005
SGLT2 vs SU_DPP4 - ADRD.4                              N/A      N/A
SGLT2 vs SU_DPP4 - stroke.1                          0.601    1.071
SGLT2 vs SU_DPP4 - stroke.2                          0.604    1.077
SGLT2 vs SU_DPP4 - stroke.3                          0.985    1.004
SGLT2 vs SU_DPP4 - stroke.4                            N/A      N/A
                                                                    hr_95ci
GLP1 vs SGLT2 - Epilepsy/Seizure.1                      0.372 (0.186-0.743)
GLP1 vs SGLT2 - Epilepsy/Seizure.2                      0.413 (0.208-0.820)
GLP1 vs SGLT2 - Epilepsy/Seizure.3                      0.900 (0.821-0.986)
GLP1 vs SGLT2 - Epilepsy/Seizure.4                -0.6831 (-0.7837--0.5824)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1          0.372 (0.186-0.743)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2          0.413 (0.208-0.820)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3          0.900 (0.821-0.986)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4    -0.6831 (-0.7837--0.5824)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1           0.356 (0.166-0.764)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2           0.381 (0.179-0.812)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3           0.934 (0.847-1.030)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4     -0.6451 (-0.7494--0.5408)
GLP1 vs SGLT2 - ADRD.1                                  0.583 (0.363-0.938)
GLP1 vs SGLT2 - ADRD.2                                  0.646 (0.404-1.031)
GLP1 vs SGLT2 - ADRD.3                                  0.903 (0.834-0.978)
GLP1 vs SGLT2 - ADRD.4                            -0.6903 (-0.7905--0.5902)
GLP1 vs SGLT2 - stroke.1                                0.943 (0.625-1.423)
GLP1 vs SGLT2 - stroke.2                                1.054 (0.703-1.580)
GLP1 vs SGLT2 - stroke.3                                0.895 (0.832-0.963)
GLP1 vs SGLT2 - stroke.4                          -0.6829 (-0.7860--0.5799)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1                    0.386 (0.221-0.675)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2                    0.392 (0.225-0.682)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3                    0.986 (0.916-1.061)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4              -0.6778 (-0.7763--0.5792)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1        0.386 (0.221-0.675)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2        0.392 (0.225-0.682)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3        0.986 (0.916-1.061)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  -0.6778 (-0.7763--0.5792)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1         0.406 (0.223-0.740)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2         0.416 (0.229-0.754)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3         0.977 (0.909-1.050)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   -0.5989 (-0.7009--0.4969)
GLP1 vs SU_DPP4 - ADRD.1                                0.729 (0.493-1.080)
GLP1 vs SU_DPP4 - ADRD.2                                0.765 (0.520-1.126)
GLP1 vs SU_DPP4 - ADRD.3                                0.953 (0.889-1.021)
GLP1 vs SU_DPP4 - ADRD.4                          -0.6877 (-0.7854--0.5900)
GLP1 vs SU_DPP4 - stroke.1                              0.691 (0.483-0.988)
GLP1 vs SU_DPP4 - stroke.2                              0.795 (0.558-1.132)
GLP1 vs SU_DPP4 - stroke.3                              0.869 (0.822-0.919)
GLP1 vs SU_DPP4 - stroke.4                        -0.7154 (-0.8163--0.6146)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1                   0.836 (0.578-1.208)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2                   0.837 (0.579-1.210)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3                   0.999 (0.995-1.003)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4              -0.0339 (-0.1199-0.0521)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1       0.836 (0.578-1.208)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2       0.837 (0.579-1.210)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3       0.999 (0.995-1.003)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  -0.0339 (-0.1199-0.0521)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1        0.856 (0.578-1.268)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2        0.855 (0.577-1.267)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3        1.001 (0.996-1.006)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4    0.0144 (-0.0734-0.1023)
SGLT2 vs SU_DPP4 - ADRD.1                               1.158 (0.870-1.541)
SGLT2 vs SU_DPP4 - ADRD.2                               1.160 (0.872-1.544)
SGLT2 vs SU_DPP4 - ADRD.3                               0.998 (0.992-1.005)
SGLT2 vs SU_DPP4 - ADRD.4                          -0.0235 (-0.1089-0.0620)
SGLT2 vs SU_DPP4 - stroke.1                             0.802 (0.601-1.071)
SGLT2 vs SU_DPP4 - stroke.2                             0.807 (0.604-1.077)
SGLT2 vs SU_DPP4 - stroke.3                             0.994 (0.985-1.004)
SGLT2 vs SU_DPP4 - stroke.4                        -0.0665 (-0.1553-0.0222)
                                                  p_value
GLP1 vs SGLT2 - Epilepsy/Seizure.1                 0.0050
GLP1 vs SGLT2 - Epilepsy/Seizure.2                 0.0115
GLP1 vs SGLT2 - Epilepsy/Seizure.3                 0.0235
GLP1 vs SGLT2 - Epilepsy/Seizure.4                 0.0000
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1     0.0050
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2     0.0115
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3     0.0235
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4     0.0000
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1      0.0080
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2      0.0125
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3      0.1723
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4      0.0000
GLP1 vs SGLT2 - ADRD.1                             0.0261
GLP1 vs SGLT2 - ADRD.2                             0.0672
GLP1 vs SGLT2 - ADRD.3                             0.0126
GLP1 vs SGLT2 - ADRD.4                             0.0000
GLP1 vs SGLT2 - stroke.1                           0.7798
GLP1 vs SGLT2 - stroke.2                           0.7995
GLP1 vs SGLT2 - stroke.3                           0.0029
GLP1 vs SGLT2 - stroke.4                           0.0000
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1               0.0009
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2               0.0009
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3               0.6995
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4               0.0000
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1   0.0009
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2   0.0009
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3   0.6995
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4   0.0000
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1    0.0032
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2    0.0039
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3    0.5276
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4    0.0000
GLP1 vs SU_DPP4 - ADRD.1                           0.1147
GLP1 vs SU_DPP4 - ADRD.2                           0.1747
GLP1 vs SU_DPP4 - ADRD.3                           0.1701
GLP1 vs SU_DPP4 - ADRD.4                           0.0000
GLP1 vs SU_DPP4 - stroke.1                         0.0429
GLP1 vs SU_DPP4 - stroke.2                         0.2033
GLP1 vs SU_DPP4 - stroke.3                         0.0000
GLP1 vs SU_DPP4 - stroke.4                         0.0000
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1              0.3404
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2              0.3429
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3              0.6697
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4              0.4401
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1  0.3404
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2  0.3429
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3  0.6697
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  0.4401
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1   0.4371
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2   0.4349
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3   0.7615
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   0.7474
SGLT2 vs SU_DPP4 - ADRD.1                          0.3138
SGLT2 vs SU_DPP4 - ADRD.2                          0.3081
SGLT2 vs SU_DPP4 - ADRD.3                          0.6111
SGLT2 vs SU_DPP4 - ADRD.4                          0.5903
SGLT2 vs SU_DPP4 - stroke.1                        0.1349
SGLT2 vs SU_DPP4 - stroke.2                        0.1456
SGLT2 vs SU_DPP4 - stroke.3                        0.2226
SGLT2 vs SU_DPP4 - stroke.4                        0.1418

=== Mediation Results for Epilepsy/Seizure ===
                                            comparison
GLP1 vs SGLT2 - Epilepsy/Seizure.1       GLP1 vs SGLT2
GLP1 vs SGLT2 - Epilepsy/Seizure.2       GLP1 vs SGLT2
GLP1 vs SGLT2 - Epilepsy/Seizure.3       GLP1 vs SGLT2
GLP1 vs SGLT2 - Epilepsy/Seizure.4       GLP1 vs SGLT2
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4   GLP1 vs SU_DPP4
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4 SGLT2 vs SU_DPP4
                                                                                                  effect
GLP1 vs SGLT2 - Epilepsy/Seizure.1    Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - Epilepsy/Seizure.2                                          Direct Effect of Semaglutide
GLP1 vs SGLT2 - Epilepsy/Seizure.3                                     Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - Epilepsy/Seizure.4                                            A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1  Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2                                        Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3                                   Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4                                          A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1 Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2                                       Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3                                  Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4                                         A Path (Treatment → HbA1c)
                                               beta_se
GLP1 vs SGLT2 - Epilepsy/Seizure.1    -0.9890 (0.3527)
GLP1 vs SGLT2 - Epilepsy/Seizure.2    -0.8833 (0.3496)
GLP1 vs SGLT2 - Epilepsy/Seizure.3    -0.1057 (0.0467)
GLP1 vs SGLT2 - Epilepsy/Seizure.4    -0.6831 (0.0514)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1  -0.9518 (0.2854)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2  -0.9373 (0.2829)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3  -0.0145 (0.0376)
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4  -0.6778 (0.0503)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1 -0.1793 (0.1881)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2 -0.1784 (0.1881)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3 -0.0009 (0.0022)
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4 -0.0339 (0.0439)
                                                        hr_95ci p_value
GLP1 vs SGLT2 - Epilepsy/Seizure.1          0.372 (0.186-0.743)  0.0050
GLP1 vs SGLT2 - Epilepsy/Seizure.2          0.413 (0.208-0.820)  0.0115
GLP1 vs SGLT2 - Epilepsy/Seizure.3          0.900 (0.821-0.986)  0.0235
GLP1 vs SGLT2 - Epilepsy/Seizure.4    -0.6831 (-0.7837--0.5824)  0.0000
GLP1 vs SU_DPP4 - Epilepsy/Seizure.1        0.386 (0.221-0.675)  0.0009
GLP1 vs SU_DPP4 - Epilepsy/Seizure.2        0.392 (0.225-0.682)  0.0009
GLP1 vs SU_DPP4 - Epilepsy/Seizure.3        0.986 (0.916-1.061)  0.6995
GLP1 vs SU_DPP4 - Epilepsy/Seizure.4  -0.6778 (-0.7763--0.5792)  0.0000
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.1       0.836 (0.578-1.208)  0.3404
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.2       0.837 (0.579-1.210)  0.3429
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.3       0.999 (0.995-1.003)  0.6697
SGLT2 vs SU_DPP4 - Epilepsy/Seizure.4  -0.0339 (-0.1199-0.0521)  0.4401

=== Mediation Results for Early-onset Epilepsy/Seizure ===
                                                        comparison
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1       GLP1 vs SGLT2
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2       GLP1 vs SGLT2
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3       GLP1 vs SGLT2
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4       GLP1 vs SGLT2
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4   GLP1 vs SU_DPP4
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4 SGLT2 vs SU_DPP4
                                                                                                              effect
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1    Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2                                          Direct Effect of Semaglutide
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3                                     Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4                                            A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1  Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2                                        Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3                                   Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4                                          A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1 Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2                                       Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3                                  Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4                                         A Path (Treatment → HbA1c)
                                                           beta_se
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1    -0.9890 (0.3527)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2    -0.8833 (0.3496)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3    -0.1057 (0.0467)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4    -0.6831 (0.0514)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1  -0.9518 (0.2854)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2  -0.9373 (0.2829)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3  -0.0145 (0.0376)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  -0.6778 (0.0503)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1 -0.1793 (0.1881)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2 -0.1784 (0.1881)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3 -0.0009 (0.0022)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4 -0.0339 (0.0439)
                                                                    hr_95ci
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1          0.372 (0.186-0.743)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2          0.413 (0.208-0.820)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3          0.900 (0.821-0.986)
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4    -0.6831 (-0.7837--0.5824)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1        0.386 (0.221-0.675)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2        0.392 (0.225-0.682)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3        0.986 (0.916-1.061)
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  -0.6778 (-0.7763--0.5792)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1       0.836 (0.578-1.208)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2       0.837 (0.579-1.210)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3       0.999 (0.995-1.003)
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  -0.0339 (-0.1199-0.0521)
                                                  p_value
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.1     0.0050
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.2     0.0115
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.3     0.0235
GLP1 vs SGLT2 - Early-onset Epilepsy/Seizure.4     0.0000
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1   0.0009
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2   0.0009
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3   0.6995
GLP1 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4   0.0000
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.1  0.3404
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.2  0.3429
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.3  0.6697
SGLT2 vs SU_DPP4 - Early-onset Epilepsy/Seizure.4  0.4401

=== Mediation Results for Late-onset Epilepsy/Seizure ===
                                                       comparison
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1       GLP1 vs SGLT2
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2       GLP1 vs SGLT2
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3       GLP1 vs SGLT2
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4       GLP1 vs SGLT2
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   GLP1 vs SU_DPP4
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4 SGLT2 vs SU_DPP4
                                                                                                             effect
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1    Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2                                          Direct Effect of Semaglutide
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3                                     Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4                                            A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1  Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2                                        Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3                                   Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4                                          A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1 Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2                                       Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3                                  Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4                                         A Path (Treatment → HbA1c)
                                                          beta_se
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1    -1.0332 (0.3896)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2    -0.9653 (0.3864)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3    -0.0680 (0.0498)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4    -0.6451 (0.0532)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1  -0.9005 (0.3060)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2  -0.8772 (0.3037)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3  -0.0233 (0.0369)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4  -0.5989 (0.0520)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1 -0.1559 (0.2006)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2 -0.1566 (0.2006)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3  0.0008 (0.0025)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4  0.0144 (0.0448)
                                                                   hr_95ci
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1          0.356 (0.166-0.764)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2          0.381 (0.179-0.812)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3          0.934 (0.847-1.030)
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4    -0.6451 (-0.7494--0.5408)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1        0.406 (0.223-0.740)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2        0.416 (0.229-0.754)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3        0.977 (0.909-1.050)
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4  -0.5989 (-0.7009--0.4969)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1       0.856 (0.578-1.268)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2       0.855 (0.577-1.267)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3       1.001 (0.996-1.006)
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   0.0144 (-0.0734-0.1023)
                                                 p_value
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.1     0.0080
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.2     0.0125
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.3     0.1723
GLP1 vs SGLT2 - Late-onset Epilepsy/Seizure.4     0.0000
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1   0.0032
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2   0.0039
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3   0.5276
GLP1 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4   0.0000
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.1  0.4371
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.2  0.4349
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.3  0.7615
SGLT2 vs SU_DPP4 - Late-onset Epilepsy/Seizure.4  0.7474

=== Mediation Results for ADRD ===
                                comparison
GLP1 vs SGLT2 - ADRD.1       GLP1 vs SGLT2
GLP1 vs SGLT2 - ADRD.2       GLP1 vs SGLT2
GLP1 vs SGLT2 - ADRD.3       GLP1 vs SGLT2
GLP1 vs SGLT2 - ADRD.4       GLP1 vs SGLT2
GLP1 vs SU_DPP4 - ADRD.1   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - ADRD.2   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - ADRD.3   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - ADRD.4   GLP1 vs SU_DPP4
SGLT2 vs SU_DPP4 - ADRD.1 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - ADRD.2 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - ADRD.3 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - ADRD.4 SGLT2 vs SU_DPP4
                                                                                      effect
GLP1 vs SGLT2 - ADRD.1    Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - ADRD.2                                          Direct Effect of Semaglutide
GLP1 vs SGLT2 - ADRD.3                                     Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - ADRD.4                                            A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - ADRD.1  Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - ADRD.2                                        Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - ADRD.3                                   Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - ADRD.4                                          A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - ADRD.1 Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - ADRD.2                                       Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - ADRD.3                                  Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - ADRD.4                                         A Path (Treatment → HbA1c)
                                   beta_se                   hr_95ci p_value
GLP1 vs SGLT2 - ADRD.1    -0.5388 (0.2423)       0.583 (0.363-0.938)  0.0261
GLP1 vs SGLT2 - ADRD.2    -0.4372 (0.2388)       0.646 (0.404-1.031)  0.0672
GLP1 vs SGLT2 - ADRD.3    -0.1017 (0.0408)       0.903 (0.834-0.978)  0.0126
GLP1 vs SGLT2 - ADRD.4    -0.6903 (0.0511) -0.6903 (-0.7905--0.5902)  0.0000
GLP1 vs SU_DPP4 - ADRD.1  -0.3156 (0.2001)       0.729 (0.493-1.080)  0.1147
GLP1 vs SU_DPP4 - ADRD.2  -0.2674 (0.1970)       0.765 (0.520-1.126)  0.1747
GLP1 vs SU_DPP4 - ADRD.3  -0.0483 (0.0352)       0.953 (0.889-1.021)  0.1701
GLP1 vs SU_DPP4 - ADRD.4  -0.6877 (0.0498) -0.6877 (-0.7854--0.5900)  0.0000
SGLT2 vs SU_DPP4 - ADRD.1  0.1468 (0.1458)       1.158 (0.870-1.541)  0.3138
SGLT2 vs SU_DPP4 - ADRD.2  0.1485 (0.1457)       1.160 (0.872-1.544)  0.3081
SGLT2 vs SU_DPP4 - ADRD.3 -0.0017 (0.0033)       0.998 (0.992-1.005)  0.6111
SGLT2 vs SU_DPP4 - ADRD.4 -0.0235 (0.0436)  -0.0235 (-0.1089-0.0620)  0.5903

=== Mediation Results for stroke ===
                                  comparison
GLP1 vs SGLT2 - stroke.1       GLP1 vs SGLT2
GLP1 vs SGLT2 - stroke.2       GLP1 vs SGLT2
GLP1 vs SGLT2 - stroke.3       GLP1 vs SGLT2
GLP1 vs SGLT2 - stroke.4       GLP1 vs SGLT2
GLP1 vs SU_DPP4 - stroke.1   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - stroke.2   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - stroke.3   GLP1 vs SU_DPP4
GLP1 vs SU_DPP4 - stroke.4   GLP1 vs SU_DPP4
SGLT2 vs SU_DPP4 - stroke.1 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - stroke.2 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - stroke.3 SGLT2 vs SU_DPP4
SGLT2 vs SU_DPP4 - stroke.4 SGLT2 vs SU_DPP4
                                                                                        effect
GLP1 vs SGLT2 - stroke.1    Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SGLT2 - stroke.2                                          Direct Effect of Semaglutide
GLP1 vs SGLT2 - stroke.3                                     Indirect Effect mediated by HbA1c
GLP1 vs SGLT2 - stroke.4                                            A Path (Treatment → HbA1c)
GLP1 vs SU_DPP4 - stroke.1  Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
GLP1 vs SU_DPP4 - stroke.2                                        Direct Effect of Semaglutide
GLP1 vs SU_DPP4 - stroke.3                                   Indirect Effect mediated by HbA1c
GLP1 vs SU_DPP4 - stroke.4                                          A Path (Treatment → HbA1c)
SGLT2 vs SU_DPP4 - stroke.1 Total Effect of Semaglutide for Prevention of Adult-Onset Epilepsy
SGLT2 vs SU_DPP4 - stroke.2                                       Direct Effect of Semaglutide
SGLT2 vs SU_DPP4 - stroke.3                                  Indirect Effect mediated by HbA1c
SGLT2 vs SU_DPP4 - stroke.4                                         A Path (Treatment → HbA1c)
                                     beta_se                   hr_95ci p_value
GLP1 vs SGLT2 - stroke.1    -0.0586 (0.2098)       0.943 (0.625-1.423)  0.7798
GLP1 vs SGLT2 - stroke.2     0.0524 (0.2065)       1.054 (0.703-1.580)  0.7995
GLP1 vs SGLT2 - stroke.3    -0.1111 (0.0372)       0.895 (0.832-0.963)  0.0029
GLP1 vs SGLT2 - stroke.4    -0.6829 (0.0526) -0.6829 (-0.7860--0.5799)  0.0000
GLP1 vs SU_DPP4 - stroke.1  -0.3698 (0.1827)       0.691 (0.483-0.988)  0.0429
GLP1 vs SU_DPP4 - stroke.2  -0.2296 (0.1804)       0.795 (0.558-1.132)  0.2033
GLP1 vs SU_DPP4 - stroke.3  -0.1402 (0.0284)       0.869 (0.822-0.919)  0.0000
GLP1 vs SU_DPP4 - stroke.4  -0.7154 (0.0515) -0.7154 (-0.8163--0.6146)  0.0000
SGLT2 vs SU_DPP4 - stroke.1 -0.2207 (0.1476)       0.802 (0.601-1.071)  0.1349
SGLT2 vs SU_DPP4 - stroke.2 -0.2147 (0.1475)       0.807 (0.604-1.077)  0.1456
SGLT2 vs SU_DPP4 - stroke.3 -0.0060 (0.0049)       0.994 (0.985-1.004)  0.2226
SGLT2 vs SU_DPP4 - stroke.4 -0.0665 (0.0453)  -0.0665 (-0.1553-0.0222)  0.1418

==== TMLE 분석 결과 요약 ====
   method       comparison                      outcome  effect_measure
1    TMLE    GLP1 vs SGLT2             Epilepsy/Seizure Risk Difference
2    TMLE    GLP1 vs SGLT2             Epilepsy/Seizure      Odds Ratio
3    TMLE    GLP1 vs SGLT2 Early-onset Epilepsy/Seizure Risk Difference
4    TMLE    GLP1 vs SGLT2 Early-onset Epilepsy/Seizure      Odds Ratio
5    TMLE    GLP1 vs SGLT2  Late-onset Epilepsy/Seizure Risk Difference
6    TMLE    GLP1 vs SGLT2  Late-onset Epilepsy/Seizure      Odds Ratio
7    TMLE    GLP1 vs SGLT2                         ADRD Risk Difference
8    TMLE    GLP1 vs SGLT2                         ADRD      Odds Ratio
9    TMLE    GLP1 vs SGLT2                       stroke Risk Difference
10   TMLE    GLP1 vs SGLT2                       stroke      Odds Ratio
11   TMLE  GLP1 vs SU_DPP4             Epilepsy/Seizure Risk Difference
12   TMLE  GLP1 vs SU_DPP4             Epilepsy/Seizure      Odds Ratio
13   TMLE  GLP1 vs SU_DPP4 Early-onset Epilepsy/Seizure Risk Difference
14   TMLE  GLP1 vs SU_DPP4 Early-onset Epilepsy/Seizure      Odds Ratio
15   TMLE  GLP1 vs SU_DPP4  Late-onset Epilepsy/Seizure Risk Difference
16   TMLE  GLP1 vs SU_DPP4  Late-onset Epilepsy/Seizure      Odds Ratio
17   TMLE  GLP1 vs SU_DPP4                         ADRD Risk Difference
18   TMLE  GLP1 vs SU_DPP4                         ADRD      Odds Ratio
19   TMLE  GLP1 vs SU_DPP4                       stroke Risk Difference
20   TMLE  GLP1 vs SU_DPP4                       stroke      Odds Ratio
21   TMLE SGLT2 vs SU_DPP4             Epilepsy/Seizure Risk Difference
22   TMLE SGLT2 vs SU_DPP4             Epilepsy/Seizure      Odds Ratio
23   TMLE SGLT2 vs SU_DPP4 Early-onset Epilepsy/Seizure Risk Difference
24   TMLE SGLT2 vs SU_DPP4 Early-onset Epilepsy/Seizure      Odds Ratio
25   TMLE SGLT2 vs SU_DPP4  Late-onset Epilepsy/Seizure Risk Difference
26   TMLE SGLT2 vs SU_DPP4  Late-onset Epilepsy/Seizure      Odds Ratio
27   TMLE SGLT2 vs SU_DPP4                         ADRD Risk Difference
28   TMLE SGLT2 vs SU_DPP4                         ADRD      Odds Ratio
29   TMLE SGLT2 vs SU_DPP4                       stroke Risk Difference
30   TMLE SGLT2 vs SU_DPP4                       stroke      Odds Ratio
   estimate lower_ci upper_ci     p_value n_total n_events
1   -0.0097  -0.0168  -0.0025 0.008033297    5839       96
2    0.4900   0.2600   0.9400 0.030609726    5839       96
3   -0.0008  -0.0035   0.0018 0.542734865    5839       13
4    0.6900   0.2000   2.3400 0.553104813    5839       13
5   -0.0099  -0.0173  -0.0025 0.008899377    5839       83
6    0.4600   0.2300   0.9600 0.037706850    5839       83
7   -0.0108  -0.0207  -0.0009 0.032384891    5950      159
8    0.6400   0.3900   1.0200 0.062932325    5950      159
9    0.0031  -0.0111   0.0172 0.671080389    5577      181
10   1.1000   0.7200   1.6600 0.662376479    5577      181
11  -0.0102  -0.0174  -0.0031 0.004829009    8216      172
12   0.5600   0.3500   0.9000 0.017266352    8216      172
13  -0.0001  -0.0034   0.0033 0.960229837    8216       24
14   0.9700   0.3300   2.8600 0.960517437    8216       24
15  -0.0120  -0.0194  -0.0046 0.001487234    8216      148
16   0.4800   0.2700   0.8500 0.011081796    8216      148
17  -0.0095  -0.0182  -0.0008 0.032359870    8389      243
18   0.7000   0.4800   1.0100 0.053742373    8389      243
19  -0.0063  -0.0196   0.0070 0.351323168    7969      315
20   0.8500   0.5900   1.2200 0.376703335    7969      315
21  -0.0035  -0.0103   0.0032 0.305939324    8615      180
22   0.8400   0.6100   1.1700 0.312560694    8615      180
23   0.0002  -0.0020   0.0024 0.883904585    8615       21
24   1.0700   0.4400   2.5800 0.883982138    8615       21
25  -0.0043  -0.0114   0.0028 0.236217219    8615      159
26   0.8100   0.5700   1.1600 0.242985529    8615      159
27  -0.0010  -0.0093   0.0074 0.821944890    8816      286
28   0.9700   0.7600   1.2400 0.822196101    8816      286
29  -0.0116  -0.0213  -0.0019 0.018552720    8312      334
30   0.7500   0.5900   0.9600 0.021545990    8312      334
